{"version":3,"file":"sha1.js","sourceRoot":"../../..","sources":["components/util/sha1/sha1.ts"],"sourcesContent":["/**\r\n * 使用 SHA-1 算法加密指定字符串。\r\n * @param value 要加密的字符串。\r\n * @return 返回加密后的字符串，其中只包含小写字母。\r\n * @example sha1(\"abc\") // \"a9993e364706816aba3e25717850c26c9cd0d89d\"\r\n */\r\nexport default function sha1(value: string) {\r\n    return binaryToString(calc(stringToBinary(value)));\r\n}\r\n\r\n/**\r\n * 编码使用的字符集。如果需要更改加密返回的大小写可更改此字段。\r\n */\r\nexport const hexChars = \"0123456789abcdef\";\r\n\r\n/**\r\n * 将文本转为字节数组。\r\n * @param value 要编码的文本。\r\n * @return 返回二进制字节数组。\r\n * @desc 只支持处理 ASCII 字符，如果字符编码大于 255，则会将高位截断。\r\n */\r\nexport function stringToBinary(value: string) {\r\n    const nblk = ((value.length + 8) >> 6) * 16 + 16;\r\n    const blks: number[] = [];\r\n    for (let i = 0; i < value.length; i++) {\r\n        blks[i >> 2] |= value.charCodeAt(i) << (24 - (i & 3) * 8);\r\n    }\r\n    blks[value.length >> 2] |= 0x80 << (24 - (value.length & 3) * 8);\r\n    blks[nblk - 1] = value.length * 8;\r\n    return blks;\r\n}\r\n\r\n/**\r\n * 将字节数组转为文本。\r\n * @param value 要解码的二进制数组。\r\n * @return 返回字符串。\r\n * @desc 只支持处理 ASCII 字符，如果字符编码大于 255，则会将高位截断。\r\n */\r\nexport function binaryToString(value: number[]) {\r\n    let result = \"\";\r\n    for (let i = 0; i < value.length * 4; i++) {\r\n        result += hexChars.charAt((value[i >> 2] >> ((3 - i % 4) * 8 + 4)) & 0xF) + hexChars.charAt((value[i >> 2] >> ((3 - i % 4) * 8)) & 0xF);\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * 执行 SHA-1 加密算法。\r\n * @param value 要计算的字节数组。\r\n * @return 返回已加密的字节数组。\r\n */\r\nexport function calc(value: number[]) {\r\n    const w = Array<number>(80);\r\n    let a = 1732584193;\r\n    let b = -271733879;\r\n    let c = -1732584194;\r\n    let d = 271733878;\r\n    let e = -1009589776;\r\n    for (let i = 0; i < value.length; i += 16) { // 每次处理 16 * 32 = 512 位。\r\n        const oldA = a;\r\n        const oldB = b;\r\n        const oldC = c;\r\n        const oldD = d;\r\n        const oldE = e;\r\n        const safeAdd = (x: number, y: number) => {\r\n            const lsw = (x & 0xFFFF) + (y & 0xFFFF);\r\n            return ((x >> 16) + (y >> 16) + (lsw >> 16)) << 16 | lsw & 0xFFFF;\r\n        };\r\n        const rol = (num: number, cnt: number) => num << cnt | num >>> (32 - cnt);\r\n        for (let j = 0; j < 80; j++) { // 对每个 512 位进行 80 步操作。\r\n            w[j] = j < 16 ? value[i + j] : rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1);\r\n            const t = safeAdd(safeAdd(rol(a, 5), j < 20 ? b & c | ~b & d : j < 40 ? b ^ c ^ d : j < 60 ? b & c | b & d | c & d : b ^ c ^ d), safeAdd(safeAdd(e, w[j]), j < 20 ? 1518500249 : j < 40 ? 1859775393 : j < 60 ? -1894007588 : -899497514));\r\n            e = d;\r\n            d = c;\r\n            c = rol(b, 30);\r\n            b = a;\r\n            a = t;\r\n        }\r\n        a = safeAdd(a, oldA);\r\n        b = safeAdd(b, oldB);\r\n        c = safeAdd(c, oldC);\r\n        d = safeAdd(d, oldD);\r\n        e = safeAdd(e, oldE);\r\n    }\r\n    return [a, b, c, d, e];\r\n}\r\n"],"mappings":";;IAAA;;;;;OAKG;IACH,cAA6B,KAAa;QACtC,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACvD,CAAC;IAFD,uBAEC;IAED;;OAEG;IACU,QAAA,QAAQ,GAAG,kBAAkB,CAAC;IAE3C;;;;;OAKG;IACH,wBAA+B,KAAa;QACxC,MAAM,IAAI,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC;QACjD,MAAM,IAAI,GAAa,EAAE,CAAC;QAC1B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACpC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC9D,CAAC;QACD,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACjE,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;QAClC,MAAM,CAAC,IAAI,CAAC;IAChB,CAAC;IATD,wCASC;IAED;;;;;OAKG;IACH,wBAA+B,KAAe;QAC1C,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;YACxC,MAAM,IAAI,gBAAQ,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,GAAG,gBAAQ,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;QAC5I,CAAC;QACD,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IAND,wCAMC;IAED;;;;OAIG;IACH,cAAqB,KAAe;QAChC,MAAM,CAAC,GAAG,KAAK,CAAS,EAAE,CAAC,CAAC;QAC5B,IAAI,CAAC,GAAG,UAAU,CAAC;QACnB,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC;QACnB,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;QACpB,IAAI,CAAC,GAAG,SAAS,CAAC;QAClB,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;QACpB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC;YACxC,MAAM,IAAI,GAAG,CAAC,CAAC;YACf,MAAM,IAAI,GAAG,CAAC,CAAC;YACf,MAAM,IAAI,GAAG,CAAC,CAAC;YACf,MAAM,IAAI,GAAG,CAAC,CAAC;YACf,MAAM,IAAI,GAAG,CAAC,CAAC;YACf,MAAM,OAAO,GAAG,CAAC,CAAS,EAAE,CAAS;gBACjC,MAAM,GAAG,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC;gBACxC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,GAAG,GAAG,GAAG,MAAM,CAAC;YACtE,CAAC,CAAC;YACF,MAAM,GAAG,GAAG,CAAC,GAAW,EAAE,GAAW,KAAK,GAAG,IAAI,GAAG,GAAG,GAAG,KAAK,CAAC,EAAE,GAAG,GAAG,CAAC,CAAC;YAC1E,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC1B,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBACnF,MAAM,CAAC,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,GAAG,UAAU,GAAG,CAAC,GAAG,EAAE,GAAG,UAAU,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,UAAU,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;gBAC3O,CAAC,GAAG,CAAC,CAAC;gBACN,CAAC,GAAG,CAAC,CAAC;gBACN,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;gBACf,CAAC,GAAG,CAAC,CAAC;gBACN,CAAC,GAAG,CAAC,CAAC;YACV,CAAC;YACD,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;YACrB,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;YACrB,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;YACrB,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;YACrB,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QACzB,CAAC;QACD,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC3B,CAAC;IAlCD,oBAkCC"}