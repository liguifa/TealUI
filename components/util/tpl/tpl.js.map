{"version":3,"file":"tpl.js","sourceRoot":"../../..","sources":["components/util/tpl/tpl.ts"],"sourcesContent":["/**\r\n * 渲染一个 EJS 模板。\r\n * @param tpl 模板内容。\r\n * @param data 传入给模板的数据。\r\n * @return 如果提供了数据，则返回执行后的结果。否则返回编译后的模板函数。\r\n */\r\nexport default function tpl(tpl: string, data?: any) {\r\n    let end = \"\";\r\n    tpl = `var $output=\"\",$t${(`%>${tpl}<%`).replace(/%>([\\s\\S]*?)<%(=?)/g, (all, content: string, eq?: string) => {\r\n        all = `${end};${content ? `$output+=${JSON.stringify(content)};` : \"\"}`;\r\n        if (eq) {\r\n            all += `$t =(`;\r\n            end = \");if($t!=null)$output+=$t\";\r\n        } else {\r\n            end = \"\";\r\n        }\r\n        return all;\r\n    })}`;\r\n    const func = new Function(\"$\", `${tpl}${end}return $output`);\r\n    if (data === undefined) {\r\n        return func;\r\n    }\r\n    return func.call(data, data);\r\n}\r\n"],"mappings":";;IAAA;;;;;OAKG;IACH,aAA4B,GAAW,EAAE,IAAU;QAC/C,IAAI,GAAG,GAAG,EAAE,CAAC;QACb,GAAG,GAAG,oBAAoB,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,OAAO,CAAC,qBAAqB,EAAE,CAAC,GAAG,EAAE,OAAe,EAAE,EAAW;YACtG,GAAG,GAAG,GAAG,GAAG,IAAI,OAAO,GAAG,YAAY,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,GAAG,EAAE,EAAE,CAAC;YACxE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACL,GAAG,IAAI,OAAO,CAAC;gBACf,GAAG,GAAG,2BAA2B,CAAC;YACtC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,GAAG,GAAG,EAAE,CAAC;YACb,CAAC;YACD,MAAM,CAAC,GAAG,CAAC;QACf,CAAC,CAAC,EAAE,CAAC;QACL,MAAM,IAAI,GAAG,IAAI,QAAQ,CAAC,GAAG,EAAE,GAAG,GAAG,GAAG,GAAG,gBAAgB,CAAC,CAAC;QAC7D,EAAE,CAAC,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC;YACrB,MAAM,CAAC,IAAI,CAAC;QAChB,CAAC;QACD,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACjC,CAAC;IAjBD,sBAiBC"}