{"version":3,"file":"markdown.js","sourceRoot":"../../..","sources":["components/util/markdown/markdown.js"],"sourcesContent":["// Released under MIT license\r\n// Copyright (c) 2009-2010 Dominic Baggott\r\n// Copyright (c) 2009-2010 Ash Berlin\r\n// Copyright (c) 2011 Christoph Dorn <christoph@christophdorn.com> (http://www.christophdorn.com)\r\n\r\n(function( expose ) {\r\n\r\n/**\r\n *  class Markdown\r\n *\r\n *  Markdown processing in Javascript done right. We have very particular views\r\n *  on what constitutes 'right' which include:\r\n *\r\n *  - produces well-formed HTML (this means that em and strong nesting is\r\n *    important)\r\n *\r\n *  - has an intermediate representation to allow processing of parsed data (We\r\n *    in fact have two, both as [JsonML]: a markdown tree and an HTML tree).\r\n *\r\n *  - is easily extensible to add new dialects without having to rewrite the\r\n *    entire parsing mechanics\r\n *\r\n *  - has a good test suite\r\n *\r\n *  This implementation fulfills all of these (except that the test suite could\r\n *  do with expanding to automatically run all the fixtures from other Markdown\r\n *  implementations.)\r\n *\r\n *  ##### Intermediate Representation\r\n *\r\n *  *TODO* Talk about this :) Its JsonML, but document the node names we use.\r\n *\r\n *  [JsonML]: http://jsonml.org/ \"JSON Markup Language\"\r\n **/\r\nvar Markdown = expose.Markdown = function Markdown(dialect) {\r\n  switch (typeof dialect) {\r\n    case \"undefined\":\r\n      this.dialect = Markdown.dialects.Gruber;\r\n      break;\r\n    case \"object\":\r\n      this.dialect = dialect;\r\n      break;\r\n    default:\r\n      if (dialect in Markdown.dialects) {\r\n        this.dialect = Markdown.dialects[dialect];\r\n      }\r\n      else {\r\n        throw new Error(\"Unknown Markdown dialect '\" + String(dialect) + \"'\");\r\n      }\r\n      break;\r\n  }\r\n  this.em_state = [];\r\n  this.strong_state = [];\r\n  this.debug_indent = \"\";\r\n};\r\n\r\n/**\r\n *  parse( markdown, [dialect] ) -> JsonML\r\n *  - markdown (String): markdown string to parse\r\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\r\n *\r\n *  Parse `markdown` and return a markdown document as a Markdown.JsonML tree.\r\n **/\r\nexpose.parse = function( source, dialect ) {\r\n  // dialect will default if undefined\r\n  var md = new Markdown( dialect );\r\n  return md.toTree( source );\r\n};\r\n\r\n/**\r\n *  toHTML( markdown, [dialect]  ) -> String\r\n *  toHTML( md_tree ) -> String\r\n *  - markdown (String): markdown string to parse\r\n *  - md_tree (Markdown.JsonML): parsed markdown tree\r\n *\r\n *  Take markdown (either as a string or as a JsonML tree) and run it through\r\n *  [[toHTMLTree]] then turn it into a well-formated HTML fragment.\r\n **/\r\nexpose.toHTML = function toHTML( source , dialect , options ) {\r\n  var input = expose.toHTMLTree( source , dialect , options );\r\n\r\n  return expose.renderJsonML( input );\r\n};\r\n\r\n/**\r\n *  toHTMLTree( markdown, [dialect] ) -> JsonML\r\n *  toHTMLTree( md_tree ) -> JsonML\r\n *  - markdown (String): markdown string to parse\r\n *  - dialect (String | Dialect): the dialect to use, defaults to gruber\r\n *  - md_tree (Markdown.JsonML): parsed markdown tree\r\n *\r\n *  Turn markdown into HTML, represented as a JsonML tree. If a string is given\r\n *  to this function, it is first parsed into a markdown tree by calling\r\n *  [[parse]].\r\n **/\r\nexpose.toHTMLTree = function toHTMLTree( input, dialect , options ) {\r\n  // convert string input to an MD tree\r\n  if ( typeof input ===\"string\" ) input = this.parse( input, dialect );\r\n\r\n  // Now convert the MD tree to an HTML tree\r\n\r\n  // remove references from the tree\r\n  var attrs = extract_attr( input ),\r\n      refs = {};\r\n\r\n  if ( attrs && attrs.references ) {\r\n    refs = attrs.references;\r\n  }\r\n\r\n  var html = convert_tree_to_html( input, refs , options );\r\n  merge_text_nodes( html );\r\n  return html;\r\n};\r\n\r\n// For Spidermonkey based engines\r\nfunction mk_block_toSource() {\r\n  return \"Markdown.mk_block( \" +\r\n          uneval(this.toString()) +\r\n          \", \" +\r\n          uneval(this.trailing) +\r\n          \", \" +\r\n          uneval(this.lineNumber) +\r\n          \" )\";\r\n}\r\n\r\n// node\r\nfunction mk_block_inspect() {\r\n  var util = require('util');\r\n  return \"Markdown.mk_block( \" +\r\n          util.inspect(this.toString()) +\r\n          \", \" +\r\n          util.inspect(this.trailing) +\r\n          \", \" +\r\n          util.inspect(this.lineNumber) +\r\n          \" )\";\r\n\r\n}\r\n\r\nvar mk_block = Markdown.mk_block = function(block, trail, line) {\r\n  // Be helpful for default case in tests.\r\n  if ( arguments.length == 1 ) trail = \"\\n\\n\";\r\n\r\n  var s = new String(block);\r\n  s.trailing = trail;\r\n  // To make it clear its not just a string\r\n  s.inspect = mk_block_inspect;\r\n  s.toSource = mk_block_toSource;\r\n\r\n  if (line != undefined)\r\n    s.lineNumber = line;\r\n\r\n  return s;\r\n};\r\n\r\nfunction count_lines( str ) {\r\n  var n = 0, i = -1;\r\n  while ( ( i = str.indexOf('\\n', i+1) ) !== -1) n++;\r\n  return n;\r\n}\r\n\r\n// Internal - split source into rough blocks\r\nMarkdown.prototype.split_blocks = function splitBlocks( input, startLine ) {\r\n  // [\\s\\S] matches _anything_ (newline or space)\r\n  var re = /([\\s\\S]+?)($|\\n(?:\\s*\\n|$)+)/g,\r\n      blocks = [],\r\n      m;\r\n\r\n  var line_no = 1;\r\n\r\n  if ( ( m = /^(\\s*\\n)/.exec(input) ) != null ) {\r\n    // skip (but count) leading blank lines\r\n    line_no += count_lines( m[0] );\r\n    re.lastIndex = m[0].length;\r\n  }\r\n\r\n  while ( ( m = re.exec(input) ) !== null ) {\r\n    blocks.push( mk_block( m[1], m[2], line_no ) );\r\n    line_no += count_lines( m[0] );\r\n  }\r\n\r\n  return blocks;\r\n};\r\n\r\n/**\r\n *  Markdown#processBlock( block, next ) -> undefined | [ JsonML, ... ]\r\n *  - block (String): the block to process\r\n *  - next (Array): the following blocks\r\n *\r\n * Process `block` and return an array of JsonML nodes representing `block`.\r\n *\r\n * It does this by asking each block level function in the dialect to process\r\n * the block until one can. Succesful handling is indicated by returning an\r\n * array (with zero or more JsonML nodes), failure by a false value.\r\n *\r\n * Blocks handlers are responsible for calling [[Markdown#processInline]]\r\n * themselves as appropriate.\r\n *\r\n * If the blocks were split incorrectly or adjacent blocks need collapsing you\r\n * can adjust `next` in place using shift/splice etc.\r\n *\r\n * If any of this default behaviour is not right for the dialect, you can\r\n * define a `__call__` method on the dialect that will get invoked to handle\r\n * the block processing.\r\n */\r\nMarkdown.prototype.processBlock = function processBlock( block, next ) {\r\n  var cbs = this.dialect.block,\r\n      ord = cbs.__order__;\r\n\r\n  if ( \"__call__\" in cbs ) {\r\n    return cbs.__call__.call(this, block, next);\r\n  }\r\n\r\n  for ( var i = 0; i < ord.length; i++ ) {\r\n    //D:this.debug( \"Testing\", ord[i] );\r\n    var res = cbs[ ord[i] ].call( this, block, next );\r\n    if ( res ) {\r\n      //D:this.debug(\"  matched\");\r\n      if ( !isArray(res) || ( res.length > 0 && !( isArray(res[0]) ) ) )\r\n        this.debug(ord[i], \"didn't return a proper array\");\r\n      //D:this.debug( \"\" );\r\n      return res;\r\n    }\r\n  }\r\n\r\n  // Uhoh! no match! Should we throw an error?\r\n  return [];\r\n};\r\n\r\nMarkdown.prototype.processInline = function processInline( block ) {\r\n  return this.dialect.inline.__call__.call( this, String( block ) );\r\n};\r\n\r\n/**\r\n *  Markdown#toTree( source ) -> JsonML\r\n *  - source (String): markdown source to parse\r\n *\r\n *  Parse `source` into a JsonML tree representing the markdown document.\r\n **/\r\n// custom_tree means set this.tree to `custom_tree` and restore old value on return\r\nMarkdown.prototype.toTree = function toTree( source, custom_root ) {\r\n  var blocks = source instanceof Array ? source : this.split_blocks( source );\r\n\r\n  // Make tree a member variable so its easier to mess with in extensions\r\n  var old_tree = this.tree;\r\n  try {\r\n    this.tree = custom_root || this.tree || [ \"markdown\" ];\r\n\r\n    blocks:\r\n    while ( blocks.length ) {\r\n      var b = this.processBlock( blocks.shift(), blocks );\r\n\r\n      // Reference blocks and the like won't return any content\r\n      if ( !b.length ) continue blocks;\r\n\r\n      this.tree.push.apply( this.tree, b );\r\n    }\r\n    return this.tree;\r\n  }\r\n  finally {\r\n    if ( custom_root ) {\r\n      this.tree = old_tree;\r\n    }\r\n  }\r\n};\r\n\r\n// Noop by default\r\nMarkdown.prototype.debug = function () {\r\n  var args = Array.prototype.slice.call( arguments);\r\n  args.unshift(this.debug_indent);\r\n  if (typeof print !== \"undefined\")\r\n      print.apply( print, args );\r\n  if (typeof console !== \"undefined\" && typeof console.log !== \"undefined\")\r\n      console.log.apply( null, args );\r\n}\r\n\r\nMarkdown.prototype.loop_re_over_block = function( re, block, cb ) {\r\n  // Dont use /g regexps with this\r\n  var m,\r\n      b = block.valueOf();\r\n\r\n  while ( b.length && (m = re.exec(b) ) != null) {\r\n    b = b.substr( m[0].length );\r\n    cb.call(this, m);\r\n  }\r\n  return b;\r\n};\r\n\r\n/**\r\n * Markdown.dialects\r\n *\r\n * Namespace of built-in dialects.\r\n **/\r\nMarkdown.dialects = {};\r\n\r\n/**\r\n * Markdown.dialects.Gruber\r\n *\r\n * The default dialect that follows the rules set out by John Gruber's\r\n * markdown.pl as closely as possible. Well actually we follow the behaviour of\r\n * that script which in some places is not exactly what the syntax web page\r\n * says.\r\n **/\r\nMarkdown.dialects.Gruber = {\r\n  block: {\r\n    atxHeader: function atxHeader( block, next ) {\r\n      var m = block.match( /^(#{1,6})\\s*(.*?)\\s*#*\\s*(?:\\n|$)/ );\r\n\r\n      if ( !m ) return undefined;\r\n\r\n      var header = [ \"header\", { level: m[ 1 ].length } ];\r\n      Array.prototype.push.apply(header, this.processInline(m[ 2 ]));\r\n\r\n      if ( m[0].length < block.length )\r\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\r\n\r\n      return [ header ];\r\n    },\r\n\r\n    setextHeader: function setextHeader( block, next ) {\r\n      var m = block.match( /^(.*)\\n([-=])\\2\\2+(?:\\n|$)/ );\r\n\r\n      if ( !m ) return undefined;\r\n\r\n      var level = ( m[ 2 ] === \"=\" ) ? 1 : 2;\r\n      var header = [ \"header\", { level : level }, m[ 1 ] ];\r\n\r\n      if ( m[0].length < block.length )\r\n        next.unshift( mk_block( block.substr( m[0].length ), block.trailing, block.lineNumber + 2 ) );\r\n\r\n      return [ header ];\r\n    },\r\n\r\n    code: function code( block, next ) {\r\n      // |    Foo\r\n      // |bar\r\n      // should be a code block followed by a paragraph. Fun\r\n      //\r\n      // There might also be adjacent code block to merge.\r\n\r\n      var ret = [],\r\n          re = /^(?: {0,3}\\t| {4})(.*)\\n?/,\r\n          lines;\r\n\r\n      // 4 spaces + content\r\n      if ( !block.match( re ) ) return undefined;\r\n\r\n      block_search:\r\n      do {\r\n        // Now pull out the rest of the lines\r\n        var b = this.loop_re_over_block(\r\n                  re, block.valueOf(), function( m ) { ret.push( m[1] ); } );\r\n\r\n        if (b.length) {\r\n          // Case alluded to in first comment. push it back on as a new block\r\n          next.unshift( mk_block(b, block.trailing) );\r\n          break block_search;\r\n        }\r\n        else if (next.length) {\r\n          // Check the next block - it might be code too\r\n          if ( !next[0].match( re ) ) break block_search;\r\n\r\n          // Pull how how many blanks lines follow - minus two to account for .join\r\n          ret.push ( block.trailing.replace(/[^\\n]/g, '').substring(2) );\r\n\r\n          block = next.shift();\r\n        }\r\n        else {\r\n          break block_search;\r\n        }\r\n      } while (true);\r\n\r\n      return [ [ \"code_block\", ret.join(\"\\n\") ] ];\r\n    },\r\n\r\n    horizRule: function horizRule( block, next ) {\r\n      // this needs to find any hr in the block to handle abutting blocks\r\n      var m = block.match( /^(?:([\\s\\S]*?)\\n)?[ \\t]*([-_*])(?:[ \\t]*\\2){2,}[ \\t]*(?:\\n([\\s\\S]*))?$/ );\r\n\r\n      if ( !m ) {\r\n        return undefined;\r\n      }\r\n\r\n      var jsonml = [ [ \"hr\" ] ];\r\n\r\n      // if there's a leading abutting block, process it\r\n      if ( m[ 1 ] ) {\r\n        jsonml.unshift.apply( jsonml, this.processBlock( m[ 1 ], [] ) );\r\n      }\r\n\r\n      // if there's a trailing abutting block, stick it into next\r\n      if ( m[ 3 ] ) {\r\n        next.unshift( mk_block( m[ 3 ] ) );\r\n      }\r\n\r\n      return jsonml;\r\n    },\r\n\r\n    // There are two types of lists. Tight and loose. Tight lists have no whitespace\r\n    // between the items (and result in text just in the <li>) and loose lists,\r\n    // which have an empty line between list items, resulting in (one or more)\r\n    // paragraphs inside the <li>.\r\n    //\r\n    // There are all sorts weird edge cases about the original markdown.pl's\r\n    // handling of lists:\r\n    //\r\n    // * Nested lists are supposed to be indented by four chars per level. But\r\n    //   if they aren't, you can get a nested list by indenting by less than\r\n    //   four so long as the indent doesn't match an indent of an existing list\r\n    //   item in the 'nest stack'.\r\n    //\r\n    // * The type of the list (bullet or number) is controlled just by the\r\n    //    first item at the indent. Subsequent changes are ignored unless they\r\n    //    are for nested lists\r\n    //\r\n    lists: (function( ) {\r\n      // Use a closure to hide a few variables.\r\n      var any_list = \"[*+-]|\\\\d+\\\\.\",\r\n          bullet_list = /[*+-]/,\r\n          number_list = /\\d+\\./,\r\n          // Capture leading indent as it matters for determining nested lists.\r\n          is_list_re = new RegExp( \"^( {0,3})(\" + any_list + \")[ \\t]+\" ),\r\n          indent_re = \"(?: {0,3}\\\\t| {4})\";\r\n\r\n      // TODO: Cache this regexp for certain depths.\r\n      // Create a regexp suitable for matching an li for a given stack depth\r\n      function regex_for_depth( depth ) {\r\n\r\n        return new RegExp(\r\n          // m[1] = indent, m[2] = list_type\r\n          \"(?:^(\" + indent_re + \"{0,\" + depth + \"} {0,3})(\" + any_list + \")\\\\s+)|\" +\r\n          // m[3] = cont\r\n          \"(^\" + indent_re + \"{0,\" + (depth-1) + \"}[ ]{0,4})\"\r\n        );\r\n      }\r\n      function expand_tab( input ) {\r\n        return input.replace( / {0,3}\\t/g, \"    \" );\r\n      }\r\n\r\n      // Add inline content `inline` to `li`. inline comes from processInline\r\n      // so is an array of content\r\n      function add(li, loose, inline, nl) {\r\n        if (loose) {\r\n          li.push( [ \"para\" ].concat(inline) );\r\n          return;\r\n        }\r\n        // Hmmm, should this be any block level element or just paras?\r\n        var add_to = li[li.length -1] instanceof Array && li[li.length - 1][0] == \"para\"\r\n                   ? li[li.length -1]\r\n                   : li;\r\n\r\n        // If there is already some content in this list, add the new line in\r\n        if (nl && li.length > 1) inline.unshift(nl);\r\n\r\n        for (var i=0; i < inline.length; i++) {\r\n          var what = inline[i],\r\n              is_str = typeof what == \"string\";\r\n          if (is_str && add_to.length > 1 && typeof add_to[add_to.length-1] == \"string\" ) {\r\n            add_to[ add_to.length-1 ] += what;\r\n          }\r\n          else {\r\n            add_to.push( what );\r\n          }\r\n        }\r\n      }\r\n\r\n      // contained means have an indent greater than the current one. On\r\n      // *every* line in the block\r\n      function get_contained_blocks( depth, blocks ) {\r\n\r\n        var re = new RegExp( \"^(\" + indent_re + \"{\" + depth + \"}.*?\\\\n?)*$\" ),\r\n            replace = new RegExp(\"^\" + indent_re + \"{\" + depth + \"}\", \"gm\"),\r\n            ret = [];\r\n\r\n        while ( blocks.length > 0 ) {\r\n          if ( re.exec( blocks[0] ) ) {\r\n            var b = blocks.shift(),\r\n                // Now remove that indent\r\n                x = b.replace( replace, \"\");\r\n\r\n            ret.push( mk_block( x, b.trailing, b.lineNumber ) );\r\n          }\r\n          break;\r\n        }\r\n        return ret;\r\n      }\r\n\r\n      // passed to stack.forEach to turn list items up the stack into paras\r\n      function paragraphify(s, i, stack) {\r\n        var list = s.list;\r\n        var last_li = list[list.length-1];\r\n\r\n        if (last_li[1] instanceof Array && last_li[1][0] == \"para\") {\r\n          return;\r\n        }\r\n        if (i+1 == stack.length) {\r\n          // Last stack frame\r\n          // Keep the same array, but replace the contents\r\n          last_li.push( [\"para\"].concat( last_li.splice(1) ) );\r\n        }\r\n        else {\r\n          var sublist = last_li.pop();\r\n          last_li.push( [\"para\"].concat( last_li.splice(1) ), sublist );\r\n        }\r\n      }\r\n\r\n      // The matcher function\r\n      return function( block, next ) {\r\n        var m = block.match( is_list_re );\r\n        if ( !m ) return undefined;\r\n\r\n        function make_list( m ) {\r\n          var list = bullet_list.exec( m[2] )\r\n                   ? [\"bulletlist\"]\r\n                   : [\"numberlist\"];\r\n\r\n          stack.push( { list: list, indent: m[1] } );\r\n          return list;\r\n        }\r\n\r\n\r\n        var stack = [], // Stack of lists for nesting.\r\n            list = make_list( m ),\r\n            last_li,\r\n            loose = false,\r\n            ret = [ stack[0].list ],\r\n            i;\r\n\r\n        // Loop to search over block looking for inner block elements and loose lists\r\n        loose_search:\r\n        while( true ) {\r\n          // Split into lines preserving new lines at end of line\r\n          var lines = block.split( /(?=\\n)/ );\r\n\r\n          // We have to grab all lines for a li and call processInline on them\r\n          // once as there are some inline things that can span lines.\r\n          var li_accumulate = \"\";\r\n\r\n          // Loop over the lines in this block looking for tight lists.\r\n          tight_search:\r\n          for (var line_no=0; line_no < lines.length; line_no++) {\r\n            var nl = \"\",\r\n                l = lines[line_no].replace(/^\\n/, function(n) { nl = n; return \"\"; });\r\n\r\n            // TODO: really should cache this\r\n            var line_re = regex_for_depth( stack.length );\r\n\r\n            m = l.match( line_re );\r\n            //print( \"line:\", uneval(l), \"\\nline match:\", uneval(m) );\r\n\r\n            // We have a list item\r\n            if ( m[1] !== undefined ) {\r\n              // Process the previous list item, if any\r\n              if ( li_accumulate.length ) {\r\n                add( last_li, loose, this.processInline( li_accumulate ), nl );\r\n                // Loose mode will have been dealt with. Reset it\r\n                loose = false;\r\n                li_accumulate = \"\";\r\n              }\r\n\r\n              m[1] = expand_tab( m[1] );\r\n              var wanted_depth = Math.floor(m[1].length/4)+1;\r\n              //print( \"want:\", wanted_depth, \"stack:\", stack.length);\r\n              if ( wanted_depth > stack.length ) {\r\n                // Deep enough for a nested list outright\r\n                //print ( \"new nested list\" );\r\n                list = make_list( m );\r\n                last_li.push( list );\r\n                last_li = list[1] = [ \"listitem\" ];\r\n              }\r\n              else {\r\n                // We aren't deep enough to be strictly a new level. This is\r\n                // where Md.pl goes nuts. If the indent matches a level in the\r\n                // stack, put it there, else put it one deeper then the\r\n                // wanted_depth deserves.\r\n                var found = false;\r\n                for (i = 0; i < stack.length; i++) {\r\n                  if ( stack[ i ].indent != m[1] ) continue;\r\n                  list = stack[ i ].list;\r\n                  stack.splice( i+1 );\r\n                  found = true;\r\n                  break;\r\n                }\r\n\r\n                if (!found) {\r\n                  //print(\"not found. l:\", uneval(l));\r\n                  wanted_depth++;\r\n                  if (wanted_depth <= stack.length) {\r\n                    stack.splice(wanted_depth);\r\n                    //print(\"Desired depth now\", wanted_depth, \"stack:\", stack.length);\r\n                    list = stack[wanted_depth-1].list;\r\n                    //print(\"list:\", uneval(list) );\r\n                  }\r\n                  else {\r\n                    //print (\"made new stack for messy indent\");\r\n                    list = make_list(m);\r\n                    last_li.push(list);\r\n                  }\r\n                }\r\n\r\n                //print( uneval(list), \"last\", list === stack[stack.length-1].list );\r\n                last_li = [ \"listitem\" ];\r\n                list.push(last_li);\r\n              } // end depth of shenegains\r\n              nl = \"\";\r\n            }\r\n\r\n            // Add content\r\n            if (l.length > m[0].length) {\r\n              li_accumulate += nl + l.substr( m[0].length );\r\n            }\r\n          } // tight_search\r\n\r\n          if ( li_accumulate.length ) {\r\n            add( last_li, loose, this.processInline( li_accumulate ), nl );\r\n            // Loose mode will have been dealt with. Reset it\r\n            loose = false;\r\n            li_accumulate = \"\";\r\n          }\r\n\r\n          // Look at the next block - we might have a loose list. Or an extra\r\n          // paragraph for the current li\r\n          var contained = get_contained_blocks( stack.length, next );\r\n\r\n          // Deal with code blocks or properly nested lists\r\n          if (contained.length > 0) {\r\n            // Make sure all listitems up the stack are paragraphs\r\n            forEach( stack, paragraphify, this);\r\n\r\n            last_li.push.apply( last_li, this.toTree( contained, [] ) );\r\n          }\r\n\r\n          var next_block = next[0] && next[0].valueOf() || \"\";\r\n\r\n          if ( next_block.match(is_list_re) || next_block.match( /^ / ) ) {\r\n            block = next.shift();\r\n\r\n            // Check for an HR following a list: features/lists/hr_abutting\r\n            var hr = this.dialect.block.horizRule( block, next );\r\n\r\n            if (hr) {\r\n              ret.push.apply(ret, hr);\r\n              break;\r\n            }\r\n\r\n            // Make sure all listitems up the stack are paragraphs\r\n            forEach( stack, paragraphify, this);\r\n\r\n            loose = true;\r\n            continue loose_search;\r\n          }\r\n          break;\r\n        } // loose_search\r\n\r\n        return ret;\r\n      };\r\n    })(),\r\n\r\n    blockquote: function blockquote( block, next ) {\r\n      if ( !block.match( /^>/m ) )\r\n        return undefined;\r\n\r\n      var jsonml = [];\r\n\r\n      // separate out the leading abutting block, if any\r\n      if ( block[ 0 ] != \">\" ) {\r\n        var lines = block.split( /\\n/ ),\r\n            prev = [];\r\n\r\n        // keep shifting lines until you find a crotchet\r\n        while ( lines.length && lines[ 0 ][ 0 ] != \">\" ) {\r\n            prev.push( lines.shift() );\r\n        }\r\n\r\n        // reassemble!\r\n        block = lines.join( \"\\n\" );\r\n        jsonml.push.apply( jsonml, this.processBlock( prev.join( \"\\n\" ), [] ) );\r\n      }\r\n\r\n      // if the next block is also a blockquote merge it in\r\n      while ( next.length && next[ 0 ][ 0 ] == \">\" ) {\r\n        var b = next.shift();\r\n        block = new String(block + block.trailing + b);\r\n        block.trailing = b.trailing;\r\n      }\r\n\r\n      // Strip off the leading \"> \" and re-process as a block.\r\n      var input = block.replace( /^> ?/gm, '' ),\r\n          old_tree = this.tree;\r\n      jsonml.push( this.toTree( input, [ \"blockquote\" ] ) );\r\n\r\n      return jsonml;\r\n    },\r\n\r\n    referenceDefn: function referenceDefn( block, next) {\r\n      var re = /^\\s*\\[(.*?)\\]:\\s*(\\S+)(?:\\s+(?:(['\"])(.*?)\\3|\\((.*?)\\)))?\\n?/;\r\n      // interesting matches are [ , ref_id, url, , title, title ]\r\n\r\n      if ( !block.match(re) )\r\n        return undefined;\r\n\r\n      // make an attribute node if it doesn't exist\r\n      if ( !extract_attr( this.tree ) ) {\r\n        this.tree.splice( 1, 0, {} );\r\n      }\r\n\r\n      var attrs = extract_attr( this.tree );\r\n\r\n      // make a references hash if it doesn't exist\r\n      if ( attrs.references === undefined ) {\r\n        attrs.references = {};\r\n      }\r\n\r\n      var b = this.loop_re_over_block(re, block, function( m ) {\r\n\r\n        if ( m[2] && m[2][0] == '<' && m[2][m[2].length-1] == '>' )\r\n          m[2] = m[2].substring( 1, m[2].length - 1 );\r\n\r\n        var ref = attrs.references[ m[1].toLowerCase() ] = {\r\n          href: m[2]\r\n        };\r\n\r\n        if (m[4] !== undefined)\r\n          ref.title = m[4];\r\n        else if (m[5] !== undefined)\r\n          ref.title = m[5];\r\n\r\n      } );\r\n\r\n      if (b.length)\r\n        next.unshift( mk_block( b, block.trailing ) );\r\n\r\n      return [];\r\n    },\r\n\r\n    para: function para( block, next ) {\r\n      // everything's a para!\r\n      return [ [\"para\"].concat( this.processInline( block ) ) ];\r\n    }\r\n  }\r\n};\r\n\r\nMarkdown.dialects.Gruber.inline = {\r\n\r\n    __oneElement__: function oneElement( text, patterns_or_re, previous_nodes ) {\r\n      var m,\r\n          res,\r\n          lastIndex = 0;\r\n\r\n      patterns_or_re = patterns_or_re || this.dialect.inline.__patterns__;\r\n      var re = new RegExp( \"([\\\\s\\\\S]*?)(\" + (patterns_or_re.source || patterns_or_re) + \")\" );\r\n\r\n      m = re.exec( text );\r\n      if (!m) {\r\n        // Just boring text\r\n        return [ text.length, text ];\r\n      }\r\n      else if ( m[1] ) {\r\n        // Some un-interesting text matched. Return that first\r\n        return [ m[1].length, m[1] ];\r\n      }\r\n\r\n      var res;\r\n      if ( m[2] in this.dialect.inline ) {\r\n        res = this.dialect.inline[ m[2] ].call(\r\n                  this,\r\n                  text.substr( m.index ), m, previous_nodes || [] );\r\n      }\r\n      // Default for now to make dev easier. just slurp special and output it.\r\n      res = res || [ m[2].length, m[2] ];\r\n      return res;\r\n    },\r\n\r\n    __call__: function inline( text, patterns ) {\r\n\r\n      var out = [],\r\n          res;\r\n\r\n      function add(x) {\r\n        //D:self.debug(\"  adding output\", uneval(x));\r\n        if (typeof x == \"string\" && typeof out[out.length-1] == \"string\")\r\n          out[ out.length-1 ] += x;\r\n        else\r\n          out.push(x);\r\n      }\r\n\r\n      while ( text.length > 0 ) {\r\n        res = this.dialect.inline.__oneElement__.call(this, text, patterns, out );\r\n        text = text.substr( res.shift() );\r\n        forEach(res, add )\r\n      }\r\n\r\n      return out;\r\n    },\r\n\r\n    // These characters are intersting elsewhere, so have rules for them so that\r\n    // chunks of plain text blocks don't include them\r\n    \"]\": function () {},\r\n    \"}\": function () {},\r\n\r\n    \"\\\\\": function escaped( text ) {\r\n      // [ length of input processed, node/children to add... ]\r\n      // Only esacape: \\ ` * _ { } [ ] ( ) # * + - . !\r\n      if ( text.match( /^\\\\[\\\\`\\*_{}\\[\\]()#\\+.!\\-]/ ) )\r\n        return [ 2, text[1] ];\r\n      else\r\n        // Not an esacpe\r\n        return [ 1, \"\\\\\" ];\r\n    },\r\n\r\n    \"![\": function image( text ) {\r\n\r\n      // Unlike images, alt text is plain text only. no other elements are\r\n      // allowed in there\r\n\r\n      // ![Alt text](/path/to/img.jpg \"Optional title\")\r\n      //      1          2            3       4         <--- captures\r\n      var m = text.match( /^!\\[(.*?)\\][ \\t]*\\([ \\t]*(\\S*)(?:[ \\t]+([\"'])(.*?)\\3)?[ \\t]*\\)/ );\r\n\r\n      if ( m ) {\r\n        if ( m[2] && m[2][0] == '<' && m[2][m[2].length-1] == '>' )\r\n          m[2] = m[2].substring( 1, m[2].length - 1 );\r\n\r\n        m[2] = this.dialect.inline.__call__.call( this, m[2], /\\\\/ )[0];\r\n\r\n        var attrs = { alt: m[1], href: m[2] || \"\" };\r\n        if ( m[4] !== undefined)\r\n          attrs.title = m[4];\r\n\r\n        return [ m[0].length, [ \"img\", attrs ] ];\r\n      }\r\n\r\n      // ![Alt text][id]\r\n      m = text.match( /^!\\[(.*?)\\][ \\t]*\\[(.*?)\\]/ );\r\n\r\n      if ( m ) {\r\n        // We can't check if the reference is known here as it likely wont be\r\n        // found till after. Check it in md tree->hmtl tree conversion\r\n        return [ m[0].length, [ \"img_ref\", { alt: m[1], ref: m[2].toLowerCase(), original: m[0] } ] ];\r\n      }\r\n\r\n      // Just consume the '!['\r\n      return [ 2, \"![\" ];\r\n    },\r\n\r\n    \"[\": function link( text ) {\r\n\r\n      var orig = String(text);\r\n      // Inline content is possible inside `link text`\r\n      var res = Markdown.DialectHelpers.inline_until_char.call( this, text.substr(1), ']' );\r\n\r\n      // No closing ']' found. Just consume the [\r\n      if ( !res ) return [ 1, '[' ];\r\n\r\n      var consumed = 1 + res[ 0 ],\r\n          children = res[ 1 ],\r\n          link,\r\n          attrs;\r\n\r\n      // At this point the first [...] has been parsed. See what follows to find\r\n      // out which kind of link we are (reference or direct url)\r\n      text = text.substr( consumed );\r\n\r\n      // [link text](/path/to/img.jpg \"Optional title\")\r\n      //                 1            2       3         <--- captures\r\n      // This will capture up to the last paren in the block. We then pull\r\n      // back based on if there a matching ones in the url\r\n      //    ([here](/url/(test))\r\n      // The parens have to be balanced\r\n      var m = text.match( /^\\s*\\([ \\t]*(\\S+)(?:[ \\t]+([\"'])(.*?)\\2)?[ \\t]*\\)/ );\r\n      if ( m ) {\r\n        var url = m[1];\r\n        consumed += m[0].length;\r\n\r\n        if ( url && url[0] == '<' && url[url.length-1] == '>' )\r\n          url = url.substring( 1, url.length - 1 );\r\n\r\n        // If there is a title we don't have to worry about parens in the url\r\n        if ( !m[3] ) {\r\n          var open_parens = 1; // One open that isn't in the capture\r\n          for (var len = 0; len < url.length; len++) {\r\n            switch ( url[len] ) {\r\n            case '(':\r\n              open_parens++;\r\n              break;\r\n            case ')':\r\n              if ( --open_parens == 0) {\r\n                consumed -= url.length - len;\r\n                url = url.substring(0, len);\r\n              }\r\n              break;\r\n            }\r\n          }\r\n        }\r\n\r\n        // Process escapes only\r\n        url = this.dialect.inline.__call__.call( this, url, /\\\\/ )[0];\r\n\r\n        attrs = { href: url || \"\" };\r\n        if ( m[3] !== undefined)\r\n          attrs.title = m[3];\r\n\r\n        link = [ \"link\", attrs ].concat( children );\r\n        return [ consumed, link ];\r\n      }\r\n\r\n      // [Alt text][id]\r\n      // [Alt text] [id]\r\n      m = text.match( /^\\s*\\[(.*?)\\]/ );\r\n\r\n      if ( m ) {\r\n\r\n        consumed += m[ 0 ].length;\r\n\r\n        // [links][] uses links as its reference\r\n        attrs = { ref: ( m[ 1 ] || String(children) ).toLowerCase(),  original: orig.substr( 0, consumed ) };\r\n\r\n        link = [ \"link_ref\", attrs ].concat( children );\r\n\r\n        // We can't check if the reference is known here as it likely wont be\r\n        // found till after. Check it in md tree->hmtl tree conversion.\r\n        // Store the original so that conversion can revert if the ref isn't found.\r\n        return [ consumed, link ];\r\n      }\r\n\r\n      // [id]\r\n      // Only if id is plain (no formatting.)\r\n      if ( children.length == 1 && typeof children[0] == \"string\" ) {\r\n\r\n        attrs = { ref: children[0].toLowerCase(),  original: orig.substr( 0, consumed ) };\r\n        link = [ \"link_ref\", attrs, children[0] ];\r\n        return [ consumed, link ];\r\n      }\r\n\r\n      // Just consume the '['\r\n      return [ 1, \"[\" ];\r\n    },\r\n\r\n\r\n    \"<\": function autoLink( text ) {\r\n      var m;\r\n\r\n      if ( ( m = text.match( /^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\\.[a-zA-Z]+))>/ ) ) != null ) {\r\n        if ( m[3] ) {\r\n          return [ m[0].length, [ \"link\", { href: \"mailto:\" + m[3] }, m[3] ] ];\r\n\r\n        }\r\n        else if ( m[2] == \"mailto\" ) {\r\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1].substr(\"mailto:\".length ) ] ];\r\n        }\r\n        else\r\n          return [ m[0].length, [ \"link\", { href: m[1] }, m[1] ] ];\r\n      }\r\n\r\n      return [ 1, \"<\" ];\r\n    },\r\n\r\n    \"`\": function inlineCode( text ) {\r\n      // Inline code block. as many backticks as you like to start it\r\n      // Always skip over the opening ticks.\r\n      var m = text.match( /(`+)(([\\s\\S]*?)\\1)/ );\r\n\r\n      if ( m && m[2] )\r\n        return [ m[1].length + m[2].length, [ \"inlinecode\", m[3] ] ];\r\n      else {\r\n        // TODO: No matching end code found - warn!\r\n        return [ 1, \"`\" ];\r\n      }\r\n    },\r\n\r\n    \"  \\n\": function lineBreak( text ) {\r\n      return [ 3, [ \"linebreak\" ] ];\r\n    }\r\n\r\n};\r\n\r\n// Meta Helper/generator method for em and strong handling\r\nfunction strong_em( tag, md ) {\r\n\r\n  var state_slot = tag + \"_state\",\r\n      other_slot = tag == \"strong\" ? \"em_state\" : \"strong_state\";\r\n\r\n  function CloseTag(len) {\r\n    this.len_after = len;\r\n    this.name = \"close_\" + md;\r\n  }\r\n\r\n  return function ( text, orig_match ) {\r\n\r\n    if (this[state_slot][0] == md) {\r\n      // Most recent em is of this type\r\n      //D:this.debug(\"closing\", md);\r\n      this[state_slot].shift();\r\n\r\n      // \"Consume\" everything to go back to the recrusion in the else-block below\r\n      return[ text.length, new CloseTag(text.length-md.length) ];\r\n    }\r\n    else {\r\n      // Store a clone of the em/strong states\r\n      var other = this[other_slot].slice(),\r\n          state = this[state_slot].slice();\r\n\r\n      this[state_slot].unshift(md);\r\n\r\n      //D:this.debug_indent += \"  \";\r\n\r\n      // Recurse\r\n      var res = this.processInline( text.substr( md.length ) );\r\n      //D:this.debug_indent = this.debug_indent.substr(2);\r\n\r\n      var last = res[res.length - 1];\r\n\r\n      //D:this.debug(\"processInline from\", tag + \": \", uneval( res ) );\r\n\r\n      var check = this[state_slot].shift();\r\n      if (last instanceof CloseTag) {\r\n        res.pop();\r\n        // We matched! Huzzah.\r\n        var consumed = text.length - last.len_after;\r\n        return [ consumed, [ tag ].concat(res) ];\r\n      }\r\n      else {\r\n        // Restore the state of the other kind. We might have mistakenly closed it.\r\n        this[other_slot] = other;\r\n        this[state_slot] = state;\r\n\r\n        // We can't reuse the processed result as it could have wrong parsing contexts in it.\r\n        return [ md.length, md ];\r\n      }\r\n    }\r\n  }; // End returned function\r\n}\r\n\r\nMarkdown.dialects.Gruber.inline[\"**\"] = strong_em(\"strong\", \"**\");\r\nMarkdown.dialects.Gruber.inline[\"__\"] = strong_em(\"strong\", \"__\");\r\nMarkdown.dialects.Gruber.inline[\"*\"]  = strong_em(\"em\", \"*\");\r\nMarkdown.dialects.Gruber.inline[\"_\"]  = strong_em(\"em\", \"_\");\r\n\r\n\r\n// Build default order from insertion order.\r\nMarkdown.buildBlockOrder = function(d) {\r\n  var ord = [];\r\n  for ( var i in d ) {\r\n    if ( i == \"__order__\" || i == \"__call__\" ) continue;\r\n    ord.push( i );\r\n  }\r\n  d.__order__ = ord;\r\n};\r\n\r\n// Build patterns for inline matcher\r\nMarkdown.buildInlinePatterns = function(d) {\r\n  var patterns = [];\r\n\r\n  for ( var i in d ) {\r\n    // __foo__ is reserved and not a pattern\r\n    if ( i.match( /^__.*__$/) ) continue;\r\n    var l = i.replace( /([\\\\.*+?|()\\[\\]{}])/g, \"\\\\$1\" )\r\n             .replace( /\\n/, \"\\\\n\" );\r\n    patterns.push( i.length == 1 ? l : \"(?:\" + l + \")\" );\r\n  }\r\n\r\n  patterns = patterns.join(\"|\");\r\n  d.__patterns__ = patterns;\r\n  //print(\"patterns:\", uneval( patterns ) );\r\n\r\n  var fn = d.__call__;\r\n  d.__call__ = function(text, pattern) {\r\n    if (pattern != undefined) {\r\n      return fn.call(this, text, pattern);\r\n    }\r\n    else\r\n    {\r\n      return fn.call(this, text, patterns);\r\n    }\r\n  };\r\n};\r\n\r\nMarkdown.DialectHelpers = {};\r\nMarkdown.DialectHelpers.inline_until_char = function( text, want ) {\r\n  var consumed = 0,\r\n      nodes = [];\r\n\r\n  while ( true ) {\r\n    if ( text[ consumed ] == want ) {\r\n      // Found the character we were looking for\r\n      consumed++;\r\n      return [ consumed, nodes ];\r\n    }\r\n\r\n    if ( consumed >= text.length ) {\r\n      // No closing char found. Abort.\r\n      return null;\r\n    }\r\n\r\n    var res = this.dialect.inline.__oneElement__.call(this, text.substr( consumed ) );\r\n    consumed += res[ 0 ];\r\n    // Add any returned nodes.\r\n    nodes.push.apply( nodes, res.slice( 1 ) );\r\n  }\r\n}\r\n\r\n// Helper function to make sub-classing a dialect easier\r\nMarkdown.subclassDialect = function( d ) {\r\n  function Block() {}\r\n  Block.prototype = d.block;\r\n  function Inline() {}\r\n  Inline.prototype = d.inline;\r\n\r\n  return { block: new Block(), inline: new Inline() };\r\n};\r\n\r\nMarkdown.buildBlockOrder ( Markdown.dialects.Gruber.block );\r\nMarkdown.buildInlinePatterns( Markdown.dialects.Gruber.inline );\r\n\r\nMarkdown.dialects.Maruku = Markdown.subclassDialect( Markdown.dialects.Gruber );\r\n\r\nMarkdown.dialects.Maruku.processMetaHash = function processMetaHash( meta_string ) {\r\n  var meta = split_meta_hash( meta_string ),\r\n      attr = {};\r\n\r\n  for ( var i = 0; i < meta.length; ++i ) {\r\n    // id: #foo\r\n    if ( /^#/.test( meta[ i ] ) ) {\r\n      attr.id = meta[ i ].substring( 1 );\r\n    }\r\n    // class: .foo\r\n    else if ( /^\\./.test( meta[ i ] ) ) {\r\n      // if class already exists, append the new one\r\n      if ( attr['class'] ) {\r\n        attr['class'] = attr['class'] + meta[ i ].replace( /./, \" \" );\r\n      }\r\n      else {\r\n        attr['class'] = meta[ i ].substring( 1 );\r\n      }\r\n    }\r\n    // attribute: foo=bar\r\n    else if ( /\\=/.test( meta[ i ] ) ) {\r\n      var s = meta[ i ].split( /\\=/ );\r\n      attr[ s[ 0 ] ] = s[ 1 ];\r\n    }\r\n  }\r\n\r\n  return attr;\r\n}\r\n\r\nfunction split_meta_hash( meta_string ) {\r\n  var meta = meta_string.split( \"\" ),\r\n      parts = [ \"\" ],\r\n      in_quotes = false;\r\n\r\n  while ( meta.length ) {\r\n    var letter = meta.shift();\r\n    switch ( letter ) {\r\n      case \" \" :\r\n        // if we're in a quoted section, keep it\r\n        if ( in_quotes ) {\r\n          parts[ parts.length - 1 ] += letter;\r\n        }\r\n        // otherwise make a new part\r\n        else {\r\n          parts.push( \"\" );\r\n        }\r\n        break;\r\n      case \"'\" :\r\n      case '\"' :\r\n        // reverse the quotes and move straight on\r\n        in_quotes = !in_quotes;\r\n        break;\r\n      case \"\\\\\" :\r\n        // shift off the next letter to be used straight away.\r\n        // it was escaped so we'll keep it whatever it is\r\n        letter = meta.shift();\r\n      default :\r\n        parts[ parts.length - 1 ] += letter;\r\n        break;\r\n    }\r\n  }\r\n\r\n  return parts;\r\n}\r\n\r\nMarkdown.dialects.Maruku.block.document_meta = function document_meta( block, next ) {\r\n  // we're only interested in the first block\r\n  if ( block.lineNumber > 1 ) return undefined;\r\n\r\n  // document_meta blocks consist of one or more lines of `Key: Value\\n`\r\n  if ( ! block.match( /^(?:\\w+:.*\\n)*\\w+:.*$/ ) ) return undefined;\r\n\r\n  // make an attribute node if it doesn't exist\r\n  if ( !extract_attr( this.tree ) ) {\r\n    this.tree.splice( 1, 0, {} );\r\n  }\r\n\r\n  var pairs = block.split( /\\n/ );\r\n  for ( p in pairs ) {\r\n    var m = pairs[ p ].match( /(\\w+):\\s*(.*)$/ ),\r\n        key = m[ 1 ].toLowerCase(),\r\n        value = m[ 2 ];\r\n\r\n    this.tree[ 1 ][ key ] = value;\r\n  }\r\n\r\n  // document_meta produces no content!\r\n  return [];\r\n};\r\n\r\nMarkdown.dialects.Maruku.block.block_meta = function block_meta( block, next ) {\r\n  // check if the last line of the block is an meta hash\r\n  var m = block.match( /(^|\\n) {0,3}\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}$/ );\r\n  if ( !m ) return undefined;\r\n\r\n  // process the meta hash\r\n  var attr = this.dialect.processMetaHash( m[ 2 ] );\r\n\r\n  var hash;\r\n\r\n  // if we matched ^ then we need to apply meta to the previous block\r\n  if ( m[ 1 ] === \"\" ) {\r\n    var node = this.tree[ this.tree.length - 1 ];\r\n    hash = extract_attr( node );\r\n\r\n    // if the node is a string (rather than JsonML), bail\r\n    if ( typeof node === \"string\" ) return undefined;\r\n\r\n    // create the attribute hash if it doesn't exist\r\n    if ( !hash ) {\r\n      hash = {};\r\n      node.splice( 1, 0, hash );\r\n    }\r\n\r\n    // add the attributes in\r\n    for ( a in attr ) {\r\n      hash[ a ] = attr[ a ];\r\n    }\r\n\r\n    // return nothing so the meta hash is removed\r\n    return [];\r\n  }\r\n\r\n  // pull the meta hash off the block and process what's left\r\n  var b = block.replace( /\\n.*$/, \"\" ),\r\n      result = this.processBlock( b, [] );\r\n\r\n  // get or make the attributes hash\r\n  hash = extract_attr( result[ 0 ] );\r\n  if ( !hash ) {\r\n    hash = {};\r\n    result[ 0 ].splice( 1, 0, hash );\r\n  }\r\n\r\n  // attach the attributes to the block\r\n  for ( a in attr ) {\r\n    hash[ a ] = attr[ a ];\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nMarkdown.dialects.Maruku.block.definition_list = function definition_list( block, next ) {\r\n  // one or more terms followed by one or more definitions, in a single block\r\n  var tight = /^((?:[^\\s:].*\\n)+):\\s+([\\s\\S]+)$/,\r\n      list = [ \"dl\" ],\r\n      i;\r\n\r\n  // see if we're dealing with a tight or loose block\r\n  if ( ( m = block.match( tight ) ) ) {\r\n    // pull subsequent tight DL blocks out of `next`\r\n    var blocks = [ block ];\r\n    while ( next.length && tight.exec( next[ 0 ] ) ) {\r\n      blocks.push( next.shift() );\r\n    }\r\n\r\n    for ( var b = 0; b < blocks.length; ++b ) {\r\n      var m = blocks[ b ].match( tight ),\r\n          terms = m[ 1 ].replace( /\\n$/, \"\" ).split( /\\n/ ),\r\n          defns = m[ 2 ].split( /\\n:\\s+/ );\r\n\r\n      // print( uneval( m ) );\r\n\r\n      for ( i = 0; i < terms.length; ++i ) {\r\n        list.push( [ \"dt\", terms[ i ] ] );\r\n      }\r\n\r\n      for ( i = 0; i < defns.length; ++i ) {\r\n        // run inline processing over the definition\r\n        list.push( [ \"dd\" ].concat( this.processInline( defns[ i ].replace( /(\\n)\\s+/, \"$1\" ) ) ) );\r\n      }\r\n    }\r\n  }\r\n  else {\r\n    return undefined;\r\n  }\r\n\r\n  return [ list ];\r\n};\r\n\r\nMarkdown.dialects.Maruku.inline[ \"{:\" ] = function inline_meta( text, matches, out ) {\r\n  if ( !out.length ) {\r\n    return [ 2, \"{:\" ];\r\n  }\r\n\r\n  // get the preceeding element\r\n  var before = out[ out.length - 1 ];\r\n\r\n  if ( typeof before === \"string\" ) {\r\n    return [ 2, \"{:\" ];\r\n  }\r\n\r\n  // match a meta hash\r\n  var m = text.match( /^\\{:\\s*((?:\\\\\\}|[^\\}])*)\\s*\\}/ );\r\n\r\n  // no match, false alarm\r\n  if ( !m ) {\r\n    return [ 2, \"{:\" ];\r\n  }\r\n\r\n  // attach the attributes to the preceeding element\r\n  var meta = this.dialect.processMetaHash( m[ 1 ] ),\r\n      attr = extract_attr( before );\r\n\r\n  if ( !attr ) {\r\n    attr = {};\r\n    before.splice( 1, 0, attr );\r\n  }\r\n\r\n  for ( var k in meta ) {\r\n    attr[ k ] = meta[ k ];\r\n  }\r\n\r\n  // cut out the string and replace it with nothing\r\n  return [ m[ 0 ].length, \"\" ];\r\n};\r\n\r\nMarkdown.buildBlockOrder ( Markdown.dialects.Maruku.block );\r\nMarkdown.buildInlinePatterns( Markdown.dialects.Maruku.inline );\r\n\r\nvar isArray = Array.isArray || function(obj) {\r\n  return Object.prototype.toString.call(obj) == '[object Array]';\r\n};\r\n\r\nvar forEach;\r\n// Don't mess with Array.prototype. Its not friendly\r\nif ( Array.prototype.forEach ) {\r\n  forEach = function( arr, cb, thisp ) {\r\n    return arr.forEach( cb, thisp );\r\n  };\r\n}\r\nelse {\r\n  forEach = function(arr, cb, thisp) {\r\n    for (var i = 0; i < arr.length; i++) {\r\n      cb.call(thisp || arr, arr[i], i, arr);\r\n    }\r\n  }\r\n}\r\n\r\nfunction extract_attr( jsonml ) {\r\n  return isArray(jsonml)\r\n      && jsonml.length > 1\r\n      && typeof jsonml[ 1 ] === \"object\"\r\n      && !( isArray(jsonml[ 1 ]) )\r\n      ? jsonml[ 1 ]\r\n      : undefined;\r\n}\r\n\r\n\r\n\r\n/**\r\n *  renderJsonML( jsonml[, options] ) -> String\r\n *  - jsonml (Array): JsonML array to render to XML\r\n *  - options (Object): options\r\n *\r\n *  Converts the given JsonML into well-formed XML.\r\n *\r\n *  The options currently understood are:\r\n *\r\n *  - root (Boolean): wether or not the root node should be included in the\r\n *    output, or just its children. The default `false` is to not include the\r\n *    root itself.\r\n */\r\nexpose.renderJsonML = function( jsonml, options ) {\r\n  options = options || {};\r\n  // include the root element in the rendered output?\r\n  options.root = options.root || false;\r\n\r\n  var content = [];\r\n\r\n  if ( options.root ) {\r\n    content.push( render_tree( jsonml ) );\r\n  }\r\n  else {\r\n    jsonml.shift(); // get rid of the tag\r\n    if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\r\n      jsonml.shift(); // get rid of the attributes\r\n    }\r\n\r\n    while ( jsonml.length ) {\r\n      content.push( render_tree( jsonml.shift() ) );\r\n    }\r\n  }\r\n\r\n  return content.join( \"\\n\\n\" );\r\n};\r\n\r\nfunction escapeHTML( text ) {\r\n  return text.replace( /&/g, \"&amp;\" )\r\n             .replace( /</g, \"&lt;\" )\r\n             .replace( />/g, \"&gt;\" )\r\n             .replace( /\"/g, \"&quot;\" )\r\n             .replace( /'/g, \"&#39;\" );\r\n}\r\n\r\nfunction render_tree( jsonml ) {\r\n  // basic case\r\n  if ( typeof jsonml === \"string\" ) {\r\n    return escapeHTML( jsonml );\r\n  }\r\n\r\n  var tag = jsonml.shift(),\r\n      attributes = {},\r\n      content = [];\r\n\r\n  if ( jsonml.length && typeof jsonml[ 0 ] === \"object\" && !( jsonml[ 0 ] instanceof Array ) ) {\r\n    attributes = jsonml.shift();\r\n  }\r\n\r\n  while ( jsonml.length ) {\r\n    content.push( arguments.callee( jsonml.shift() ) );\r\n  }\r\n\r\n  var tag_attrs = \"\";\r\n  for ( var a in attributes ) {\r\n    tag_attrs += \" \" + a + '=\"' + escapeHTML( attributes[ a ] ) + '\"';\r\n  }\r\n\r\n  // be careful about adding whitespace here for inline elements\r\n  if ( tag == \"img\" || tag == \"br\" || tag == \"hr\" ) {\r\n    return \"<\"+ tag + tag_attrs + \"/>\";\r\n  }\r\n  else {\r\n    return \"<\"+ tag + tag_attrs + \">\" + content.join( \"\" ) + \"</\" + tag + \">\";\r\n  }\r\n}\r\n\r\nfunction convert_tree_to_html( tree, references, options ) {\r\n  var i;\r\n  options = options || {};\r\n\r\n  // shallow clone\r\n  var jsonml = tree.slice( 0 );\r\n\r\n  if (typeof options.preprocessTreeNode === \"function\") {\r\n      jsonml = options.preprocessTreeNode(jsonml, references);\r\n  }\r\n\r\n  // Clone attributes if they exist\r\n  var attrs = extract_attr( jsonml );\r\n  if ( attrs ) {\r\n    jsonml[ 1 ] = {};\r\n    for ( i in attrs ) {\r\n      jsonml[ 1 ][ i ] = attrs[ i ];\r\n    }\r\n    attrs = jsonml[ 1 ];\r\n  }\r\n\r\n  // basic case\r\n  if ( typeof jsonml === \"string\" ) {\r\n    return jsonml;\r\n  }\r\n\r\n  // convert this node\r\n  switch ( jsonml[ 0 ] ) {\r\n    case \"header\":\r\n      jsonml[ 0 ] = \"h\" + jsonml[ 1 ].level;\r\n      delete jsonml[ 1 ].level;\r\n      break;\r\n    case \"bulletlist\":\r\n      jsonml[ 0 ] = \"ul\";\r\n      break;\r\n    case \"numberlist\":\r\n      jsonml[ 0 ] = \"ol\";\r\n      break;\r\n    case \"listitem\":\r\n      jsonml[ 0 ] = \"li\";\r\n      break;\r\n    case \"para\":\r\n      jsonml[ 0 ] = \"p\";\r\n      break;\r\n    case \"markdown\":\r\n      jsonml[ 0 ] = \"html\";\r\n      if ( attrs ) delete attrs.references;\r\n      break;\r\n    case \"code_block\":\r\n      jsonml[ 0 ] = \"pre\";\r\n      i = attrs ? 2 : 1;\r\n      var code = [ \"code\" ];\r\n      code.push.apply( code, jsonml.splice( i ) );\r\n      jsonml[ i ] = code;\r\n      break;\r\n    case \"inlinecode\":\r\n      jsonml[ 0 ] = \"code\";\r\n      break;\r\n    case \"img\":\r\n      jsonml[ 1 ].src = jsonml[ 1 ].href;\r\n      delete jsonml[ 1 ].href;\r\n      break;\r\n    case \"linebreak\":\r\n      jsonml[ 0 ] = \"br\";\r\n    break;\r\n    case \"link\":\r\n      jsonml[ 0 ] = \"a\";\r\n      break;\r\n    case \"link_ref\":\r\n      jsonml[ 0 ] = \"a\";\r\n\r\n      // grab this ref and clean up the attribute node\r\n      var ref = references[ attrs.ref ];\r\n\r\n      // if the reference exists, make the link\r\n      if ( ref ) {\r\n        delete attrs.ref;\r\n\r\n        // add in the href and title, if present\r\n        attrs.href = ref.href;\r\n        if ( ref.title ) {\r\n          attrs.title = ref.title;\r\n        }\r\n\r\n        // get rid of the unneeded original text\r\n        delete attrs.original;\r\n      }\r\n      // the reference doesn't exist, so revert to plain text\r\n      else {\r\n        return attrs.original;\r\n      }\r\n      break;\r\n    case \"img_ref\":\r\n      jsonml[ 0 ] = \"img\";\r\n\r\n      // grab this ref and clean up the attribute node\r\n      var ref = references[ attrs.ref ];\r\n\r\n      // if the reference exists, make the link\r\n      if ( ref ) {\r\n        delete attrs.ref;\r\n\r\n        // add in the href and title, if present\r\n        attrs.src = ref.href;\r\n        if ( ref.title ) {\r\n          attrs.title = ref.title;\r\n        }\r\n\r\n        // get rid of the unneeded original text\r\n        delete attrs.original;\r\n      }\r\n      // the reference doesn't exist, so revert to plain text\r\n      else {\r\n        return attrs.original;\r\n      }\r\n      break;\r\n  }\r\n\r\n  // convert all the children\r\n  i = 1;\r\n\r\n  // deal with the attribute node, if it exists\r\n  if ( attrs ) {\r\n    // if there are keys, skip over it\r\n    for ( var key in jsonml[ 1 ] ) {\r\n      i = 2;\r\n    }\r\n    // if there aren't, remove it\r\n    if ( i === 1 ) {\r\n      jsonml.splice( i, 1 );\r\n    }\r\n  }\r\n\r\n  for ( ; i < jsonml.length; ++i ) {\r\n    jsonml[ i ] = arguments.callee( jsonml[ i ], references, options );\r\n  }\r\n\r\n  return jsonml;\r\n}\r\n\r\n\r\n// merges adjacent text nodes into a single node\r\nfunction merge_text_nodes( jsonml ) {\r\n  // skip the tag name and attribute hash\r\n  var i = extract_attr( jsonml ) ? 2 : 1;\r\n\r\n  while ( i < jsonml.length ) {\r\n    // if it's a string check the next item too\r\n    if ( typeof jsonml[ i ] === \"string\" ) {\r\n      if ( i + 1 < jsonml.length && typeof jsonml[ i + 1 ] === \"string\" ) {\r\n        // merge the second string into the first and remove it\r\n        jsonml[ i ] += jsonml.splice( i + 1, 1 )[ 0 ];\r\n      }\r\n      else {\r\n        ++i;\r\n      }\r\n    }\r\n    // if it's not a string recurse\r\n    else {\r\n      arguments.callee( jsonml[ i ] );\r\n      ++i;\r\n    }\r\n  }\r\n}\r\n\r\n})(Markdown = {});\r\n"],"mappings":"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"}