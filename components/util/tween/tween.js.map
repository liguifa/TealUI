{"version":3,"file":"tween.js","sourceRoot":"../../..","sources":["components/util/tween/tween.ts"],"sourcesContent":["/**\r\n * 表示一个补间动画。\r\n * @example\r\n * var tween = new Tween();\r\n * tween.set = x => { console.log(x); }\r\n * tween.start();\r\n */\r\nexport default class Tween {\r\n\r\n    /**\r\n     * 渐变执行的总毫秒数。\r\n     */\r\n    duration = 300;\r\n\r\n    /**\r\n     * 每秒的显示帧数。\r\n     */\r\n    fps = 50;\r\n\r\n    /**\r\n     * 当被子类重写时负责重写渐变曲线。\r\n     * @param x 转换前的数值，大小在 0-1 之间。\r\n     * @return 返回根据渐变曲线变换后的值，大小在 0-1 之间。\r\n     */\r\n    transition(x: number) {\r\n        return -(Math.cos(Math.PI * x) - 1) / 2;\r\n    }\r\n\r\n    /**\r\n     * 当被子类重写时负责根据指定的变化量设置实际的效果值。\r\n     * @param x 当前的变化因子，大小在 0-1 之间。\r\n     */\r\n    set(x: number) { }\r\n\r\n    /**\r\n     * 当效果结束后执行。\r\n     */\r\n    done: () => void;\r\n\r\n    /**\r\n     * 开始执行渐变。\r\n     */\r\n    start() {\r\n        if (!this.timer) {\r\n            this.time = Date.now() - this.time;\r\n            this.timer = setInterval(() => {\r\n                this.step();\r\n            }, Math.round(1000 / this.fps)) as any;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 停止执行渐变。\r\n     */\r\n    stop() {\r\n        if (this.timer) {\r\n            this.time = Date.now() - this.time;\r\n            clearInterval(this.timer);\r\n            delete this.timer;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 重置执行渐变。\r\n     */\r\n    reset() {\r\n        this.time = 0;\r\n        this.set(0);\r\n    }\r\n\r\n    /**\r\n     * 存储当前渐变的计时器。\r\n     */\r\n    private timer: number;\r\n\r\n    /**\r\n     * 存储当前渐变的执行时间。\r\n     */\r\n    private time = 0;\r\n\r\n    /**\r\n     * 进入变换的下步。\r\n     */\r\n    protected step() {\r\n        const time = Date.now() - this.time;\r\n        if (time < this.duration) {\r\n            this.set(this.transition(time / this.duration));\r\n        } else {\r\n            this.stop();\r\n            this.set(1);\r\n            this.done && this.done();\r\n        }\r\n    }\r\n\r\n}\r\n"],"mappings":";;IAAA;;;;;;OAMG;IACH;QAAA;YAEI;;eAEG;YACH,aAAQ,GAAG,GAAG,CAAC;YAEf;;eAEG;YACH,QAAG,GAAG,EAAE,CAAC;YA0DT;;eAEG;YACK,SAAI,GAAG,CAAC,CAAC;QAgBrB,CAAC;QA3EG;;;;WAIG;QACH,UAAU,CAAC,CAAS;YAChB,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;QAC5C,CAAC;QAED;;;WAGG;QACH,GAAG,CAAC,CAAS,IAAI,CAAC;QAOlB;;WAEG;QACH,KAAK;YACD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;gBACd,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;gBACnC,IAAI,CAAC,KAAK,GAAG,WAAW,CAAC;oBACrB,IAAI,CAAC,IAAI,EAAE,CAAC;gBAChB,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAQ,CAAC;YAC3C,CAAC;QACL,CAAC;QAED;;WAEG;QACH,IAAI;YACA,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;gBACb,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;gBACnC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAC1B,OAAO,IAAI,CAAC,KAAK,CAAC;YACtB,CAAC;QACL,CAAC;QAED;;WAEG;QACH,KAAK;YACD,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;YACd,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAChB,CAAC;QAYD;;WAEG;QACO,IAAI;YACV,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;YACpC,EAAE,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACvB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;YACpD,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,IAAI,CAAC,IAAI,EAAE,CAAC;gBACZ,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACZ,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;YAC7B,CAAC;QACL,CAAC;KAEJ;IAvFD,wBAuFC"}