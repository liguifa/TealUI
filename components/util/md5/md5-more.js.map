{"version":3,"file":"md5-more.js","sourceRoot":"../../..","sources":["components/util/md5/md5-more.ts"],"sourcesContent":["import { calc, raw, stringToBinary, binaryToString } from \"./md5\";\r\n\r\n/**\r\n * 将字节数组转为 Base64。\r\n * @param value 要解码的二进制数组。\r\n * @return 返回字符串。\r\n * @private\r\n */\r\nexport function binaryToBase64(value: number[], base64Padding = \"\") {\r\n    let result = \"\";\r\n    for (let i = 0; i < value.length * 4; i += 3) {\r\n        const triplet = (value[i >> 2] >> i % 4 * 8 & 255) << 16 | (value[i + 1 >> 2] >> (i + 1) % 4 * 8 & 0xff) << 8 | value[i + 2 >> 2] >> (i + 2) % 4 * 8 & 0xff;\r\n        for (let j = 0; j < 4; j++) {\r\n            result += i * 8 + j * 6 > value.length * 32 ? base64Padding : (\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\".charAt((triplet >> 6 * (3 - j)) & 0x3F));\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * 使用 MD5 和 Base64 算法加密指定字符串。\r\n * @param value 要计算的字符串。\r\n * @return 返回加密后的字符串，其中只包含小写字母。\r\n * @example base64Md5(\"abc\") // \"kAFQmDzST7DWlj99KOF/cg\"\r\n */\r\nexport function base64Md5(value: string) {\r\n    return binaryToBase64(raw(value));\r\n}\r\n\r\n/**\r\n * 使用 HMAC-MD5 算法加密指定字符串。\r\n * @param value 要计算的字符串。\r\n * @param key 加密的密钥。\r\n * @return 返回加密后的字符串，其中只包含小写字母。\r\n * @example hmacMd5(\"abc\", \"key\") // \"d2fe98063f876b03193afb49b4979591\"\r\n */\r\nexport function hmacMd5(value: string, key: string) {\r\n    return binaryToString(hmacRaw(value, key));\r\n}\r\n\r\n/**\r\n * 使用 HMAC-MD5 和 Base64 算法加密指定字符串。\r\n * @param value 要计算的字符串。\r\n * @param key 加密的密钥。\r\n * @return 返回加密后的字符串，其中只包含小写字母。\r\n * @example base64HmacMd5(\"abc\", \"key\") // \"0v6YBj+HawMZOvtJtJeVkQ\"\r\n */\r\nexport function base64HmacMd5(value: string, key: string) {\r\n    return binaryToBase64(hmacRaw(value, key));\r\n}\r\n\r\n/**\r\n * 解码函数。\r\n */\r\ndeclare function unescape(value: string): string;\r\n\r\n/**\r\n * 执行 HMAC-MD5 加密算法。\r\n * @param value 要计算的字符串。\r\n * @param key 加密的密钥。\r\n * @private\r\n */\r\nexport function hmacRaw(value: string, key: string) {\r\n    value = unescape(encodeURIComponent(value));\r\n    key = unescape(encodeURIComponent(key));\r\n    let bkey = stringToBinary(key);\r\n    if (bkey.length > 16) bkey = calc(bkey, key.length * 8);\r\n\r\n    const ipad: number[] = [];\r\n    const opad: number[] = [];\r\n    for (let i = 0; i < 16; i++) {\r\n        ipad[i] = bkey[i] ^ 0x36363636;\r\n        opad[i] = bkey[i] ^ 0x5C5C5C5C;\r\n    }\r\n\r\n    return calc(opad.concat(calc(ipad.concat(stringToBinary(value)), 512 + value.length * 8)), 512 + 128);\r\n}\r\n"],"mappings":"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"}