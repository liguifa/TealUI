{"version":3,"file":"selection.js","sourceRoot":"../../../..","sources":["components/ux/selection/old/selection.ts"],"sourcesContent":["// #todo\r\n\r\n/**\r\n * @author sun\r\n */\r\n\r\nDom.getSelectionRange = function (elem) {\r\n\r\n\tvar s, e, range, stored_range;\r\n\tif (elem.selectionStart == undefined) {\r\n\t\tvar selection = document.selection;\r\n\t\tif (elem.tagName.toLowerCase() != \"textarea\") {\r\n\t\t\tvar val = Dom.getText(elem),\r\n\t\t\trange = selection.createRange().duplicate();\r\n\t\t\trange.moveEnd(\"character\", val.length);\r\n\t\t\ts = (range.text == \"\" ? val.length : val.lastIndexOf(range.text));\r\n\t\t\trange = selection.createRange().duplicate();\r\n\t\t\trange.moveStart(\"character\", -val.length);\r\n\t\t\te = range.text.length;\r\n\t\t} else {\r\n\t\t\trange = selection.createRange();\r\n\t\t\tstored_range = range.duplicate();\r\n\t\t\tstored_range.moveToElementText(elem);\r\n\t\t\tstored_range.setEndPoint('EndToEnd', range);\r\n\t\t\ts = stored_range.text.length - range.text.length;\r\n\t\t\te = s + range.text.length;\r\n\t\t}\r\n\t} else {\r\n\t\ts = elem.selectionStart;\r\n\t\te = elem.selectionEnd;\r\n\t}\r\n\tvar te = elem.value.substring(s, e);\r\n\treturn {\r\n\t\tstart: s,\r\n\t\tend: e,\r\n\t\ttext: te\r\n\t}\r\n\r\n};\r\n\r\nDom.setSelectionRange = function (elem, range) {\r\n\r\n\tif (elem.createTextRange) {\r\n\r\n\t\tvar range = elem.createTextRange();\r\n\t\trange.moveStart(\"character\", 0)\r\n\t\trange.moveEnd(\"character\", 0);\r\n\t\trange.collapse(true);\r\n\t\trange.moveEnd(\"character\", range.end);\r\n\t\trange.moveStart(\"character\", range.start);\r\n\t\trange.select();\r\n\r\n\t} else if (elem.selectionStart) {\r\n\r\n\t\telem.focus();\r\n\t\telem.setSelectionRange(range.start, range.end);\r\n\r\n\t}\r\n\r\n};\r\n\r\nDom.setCursor = function (elem, pos) {\r\n\r\n\tif (elem.createTextRange) {\r\n\t\tvar range = elem.createTextRange();\r\n\t\trange.move(\"character\", pos);\r\n\t\trange.select();\r\n\t} else if (elem.selectionStart) {\r\n\t\telem.focus();\r\n\t\telem.setSelectionRange(pos, pos);\r\n\t}\r\n\r\n};\r\n\r\nDom.implement({\r\n\r\n\t/**\r\n\t * 获取或设置选区区域范围\r\n\t * @return {Object} 返回 {start: 0, end: 3}  对象。\r\n\t */\r\n\tselectionRange: function () {\r\n\t\treturn arguments.length === 0 ? this.length ? Dom.getSelectionRange(this[0]) : null : this.iterate(Dom.setSelectionRange, arguments);\r\n\t},\r\n\r\n\t/**\r\n\t * 获取或设置选区文本\r\n\t * @param {String} 文本\r\n\t * @param {Boolean} true代表选中插入文本 false表示不选中\r\n\t * @return {String} 选中的文本\r\n\t */\r\n\tselectedText: function (value, selectInsertedText) {\r\n\t\treturn arguments.length === 0 ? this.length ? Dom.getSelectionRange(this[0]).text : null : this.iterate(function (elem) {\r\n\t\t\tvar val = Dom.getText(elem);\r\n\r\n\t\t\tvar s = Dom.getSelectionRange(elem);\r\n\r\n\t\t\tvar a = val.substring(0, s.start);\r\n\t\t\tvar b = val.substring(s.end);\r\n\r\n\t\t\tDom.setText(elem, a + value + b);\r\n\r\n\t\t\ts.end = s.start + value.length;\r\n\t\t\tif (selectInsertedText) {\r\n\t\t\t\tDom.setSelectionRange(elem, s);\r\n\t\t\t} else {\r\n\t\t\t\tDom.setCursor(elem, s.end);\r\n\t\t\t}\r\n\r\n\t\t}, arguments);\r\n\t}\r\n\r\n});\r\n"],"mappings":"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"}