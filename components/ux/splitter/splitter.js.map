{"version":3,"file":"splitter.js","sourceRoot":"../../..","sources":["components/ux/splitter/splitter.ts"],"sourcesContent":["import { Draggable } from \"ux/drag\";\r\nimport { getRect, setRect, addClass, removeClass, computeStyle } from \"ux/dom\";\r\nimport \"./splitter.scss\";\r\n\r\n/**\r\n * 表示一个分割条。\r\n */\r\nexport class Splitter extends Draggable {\r\n\r\n    /**\r\n     * 分割的第一个目标。\r\n     */\r\n    target1: HTMLElement;\r\n\r\n    /**\r\n     * 分割的第二个目标。\r\n     */\r\n    target2: HTMLElement;\r\n\r\n    /**\r\n     * 是否是水平分割条。\r\n     */\r\n    horizontal: boolean;\r\n\r\n    /**\r\n     * 当前滑块的最小位置（0-1 之间）。\r\n     */\r\n    minValue: number;\r\n\r\n    /**\r\n     * 当前滑块的最大位置（0-1 之间）。\r\n     */\r\n    maxValue: number;\r\n\r\n    /**\r\n     * 获取当前滑块的值（0-1 之间）。\r\n     */\r\n    getValue() {\r\n        const prop = this.horizontal ? \"height\" : \"width\";\r\n        return computeStyle(this.target1, prop) / computeStyle(this.target1.parentNode as HTMLElement, prop);\r\n    }\r\n\r\n    /**\r\n     * 设置当前滑块的值。\r\n     * @param value 要设置的值（0-1 之间）。\r\n     */\r\n    setValue(value: number) {\r\n        const prop = this.horizontal ? \"height\" : \"width\";\r\n        this.target1.style[prop] = value * 100 + \"%\";\r\n        this.target2.style[prop] = (1 - value) * 100 + \"%\";\r\n        this.realign();\r\n    }\r\n\r\n    /**\r\n     * 重新对齐分割条的位置。\r\n     */\r\n    realign() {\r\n        const rect = getRect(this.target2);\r\n        delete rect[this.horizontal ? \"height\" : \"width\"];\r\n        rect[this.horizontal ? \"y\" : \"x\"] -= this.elem[this.horizontal ? \"offsetHeight\" : \"offsetWidth\"] / 2;\r\n        setRect(this.elem, rect);\r\n    }\r\n\r\n    /**\r\n     * 本次拖动的开始值。\r\n     */\r\n    startValue: number;\r\n\r\n    /**\r\n     * 本次拖动的当前值。\r\n     */\r\n    endValue: number;\r\n\r\n    /**\r\n     * 触发拖动开始事件。\r\n     * @param e 事件对象。\r\n     * @return 如果返回 false 则忽略本次拖动。\r\n     */\r\n    protected dragStart(e: MouseEvent) {\r\n        addClass(this.elem, \"x-splitter-active\");\r\n        if (this.onDragStart && this.onDragStart(e, this) === false) {\r\n            return false;\r\n        }\r\n        this.startValue = this.getValue();\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 触发拖动移动事件。\r\n     * @param e 事件对象。\r\n     */\r\n    protected dragMove(e: MouseEvent) {\r\n        this.endValue = Math.min(Math.max(this.startValue + (this.horizontal ? this.endY - this.startY : this.endX - this.startX) / computeStyle(this.target1.parentNode as HTMLElement, this.horizontal ? \"height\" : \"width\"), this.minValue), this.maxValue);\r\n        if (!this.onDragMove || this.onDragMove(e, this) !== false) {\r\n            this.setValue(this.endValue);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 触发拖动结束事件。\r\n     * @param e 事件对象。\r\n     */\r\n    protected dragEnd(e: MouseEvent) {\r\n        removeClass(this.elem, \"x-splitter-active\");\r\n        this.onDragEnd && this.onDragEnd(e, this);\r\n    }\r\n\r\n}\r\n\r\nSplitter.prototype.minValue = 0.05;\r\nSplitter.prototype.maxValue = 0.95;\r\n\r\n/**\r\n * 创建一个分割条。\r\n * @param target1 分割的第一个目标。\r\n * @param target2 分割的第二个目标。\r\n * @param options 分割条的选项。\r\n */\r\nexport default function splitter(target1: HTMLElement, target2: HTMLElement, options?: Partial<Splitter>) {\r\n    const splitter = new Splitter();\r\n    splitter.target1 = target1;\r\n    splitter.target2 = target2;\r\n\r\n    splitter.handle = splitter.elem = target1.parentNode!.appendChild(document.createElement(\"div\"));\r\n    splitter.elem.className = \"x-splitter\";\r\n\r\n    Object.assign(splitter, options);\r\n    splitter.realign();\r\n    splitter.enable();\r\n    return splitter;\r\n}\r\n"],"mappings":";;IAIA;;OAEG;IACH,cAAsB,SAAQ,gBAAS;QA2BnC;;WAEG;QACH,QAAQ;YACJ,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,GAAG,QAAQ,GAAG,OAAO,CAAC;YAClD,MAAM,CAAC,kBAAY,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,GAAG,kBAAY,CAAC,IAAI,CAAC,OAAO,CAAC,UAAyB,EAAE,IAAI,CAAC,CAAC;QACzG,CAAC;QAED;;;WAGG;QACH,QAAQ,CAAC,KAAa;YAClB,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,GAAG,QAAQ,GAAG,OAAO,CAAC;YAClD,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,KAAK,GAAG,GAAG,GAAG,GAAG,CAAC;YAC7C,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC;YACnD,IAAI,CAAC,OAAO,EAAE,CAAC;QACnB,CAAC;QAED;;WAEG;QACH,OAAO;YACH,MAAM,IAAI,GAAG,aAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACnC,OAAO,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,QAAQ,GAAG,OAAO,CAAC,CAAC;YAClD,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,GAAG,GAAG,GAAG,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,cAAc,GAAG,aAAa,CAAC,GAAG,CAAC,CAAC;YACrG,aAAO,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAC7B,CAAC;QAYD;;;;WAIG;QACO,SAAS,CAAC,CAAa;YAC7B,cAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;YACzC,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC;gBAC1D,MAAM,CAAC,KAAK,CAAC;YACjB,CAAC;YACD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YAClC,MAAM,CAAC,IAAI,CAAC;QAChB,CAAC;QAED;;;WAGG;QACO,QAAQ,CAAC,CAAa;YAC5B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,kBAAY,CAAC,IAAI,CAAC,OAAO,CAAC,UAAyB,EAAE,IAAI,CAAC,UAAU,GAAG,QAAQ,GAAG,OAAO,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YACvP,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC;gBACzD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACjC,CAAC;QACL,CAAC;QAED;;;WAGG;QACO,OAAO,CAAC,CAAa;YAC3B,iBAAW,CAAC,IAAI,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;YAC5C,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;QAC9C,CAAC;KAEJ;IApGD,4BAoGC;IAED,QAAQ,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC;IACnC,QAAQ,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC;IAEnC;;;;;OAKG;IACH,kBAAiC,OAAoB,EAAE,OAAoB,EAAE,OAA2B;QACpG,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC;QAC3B,QAAQ,CAAC,OAAO,GAAG,OAAO,CAAC;QAE3B,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC,IAAI,GAAG,OAAO,CAAC,UAAW,CAAC,WAAW,CAAC,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;QACjG,QAAQ,CAAC,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC;QAEvC,MAAM,CAAC,MAAM,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACjC,QAAQ,CAAC,OAAO,EAAE,CAAC;QACnB,QAAQ,CAAC,MAAM,EAAE,CAAC;QAClB,MAAM,CAAC,QAAQ,CAAC;IACpB,CAAC;IAZD,2BAYC"}