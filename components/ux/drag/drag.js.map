{"version":3,"file":"drag.js","sourceRoot":"../../..","sources":["components/ux/drag/drag.ts"],"sourcesContent":["import { on, off, getStyle, getOffset, Rect, animate, getRect } from \"ux/dom\";\r\nimport { scrollIntoViewIfNeeded } from \"ux/scroll\";\r\n\r\n/**\r\n * 表示一个可拖动对象。\r\n */\r\nexport class Draggable {\r\n\r\n    /**\r\n     * 拖动手柄元素。只有点击手柄才能开始拖动。\r\n     */\r\n    handle: HTMLElement;\r\n\r\n    /**\r\n     * 指针按下不动到开始拖动的等待毫秒数。如果为 -1 则忽略指针按下不动的操作。\r\n     */\r\n    delay: number;\r\n\r\n    /**\r\n     * 开始拖动的最小距离。拖动距离小于这个值时认为是点击操作。\r\n     */\r\n    distance: number;\r\n\r\n    /**\r\n     * 拖动开始事件。\r\n     * @param e 事件对象。\r\n     * @param sender 事件源。\r\n     * @return 如果返回 false 则忽略本次拖动。\r\n     */\r\n    onDragStart?: (e: MouseEvent, sender: this) => boolean | void;\r\n\r\n    /**\r\n     * 拖动移动事件。\r\n     * @param e 事件对象。\r\n     * @param sender 事件源。\r\n     * @return 如果返回 false 则不更改元素的位置。\r\n     */\r\n    onDragMove?: (e: MouseEvent, sender: this) => boolean | void;\r\n\r\n    /**\r\n     * 拖动结束事件。\r\n     * @param e 事件对象。\r\n     * @param sender 事件源。\r\n     */\r\n    onDragEnd?: (e: MouseEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 拖动取消事件。\r\n     * @param e 事件对象。\r\n     * @param sender 事件源。\r\n     */\r\n    onDragCancel?: (e: MouseEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 拖动的元素。\r\n     */\r\n    elem: HTMLElement;\r\n\r\n    /**\r\n     * 启用拖动。\r\n     */\r\n    enable() { on(this.handle, \"pointerdown\", this.handlePointerDown, this); }\r\n\r\n    /**\r\n     * 禁用拖动。\r\n     */\r\n    disable() { off(this.handle, \"pointerdown\", this.handlePointerDown); }\r\n\r\n    /**\r\n     * 获取开始拖动的水平坐标。\r\n     */\r\n    startX: number;\r\n\r\n    /**\r\n     * 获取开始拖动的垂直坐标。\r\n     */\r\n    startY: number;\r\n\r\n    /**\r\n     * 获取当前的水平坐标。\r\n     */\r\n    endX: number;\r\n\r\n    /**\r\n     * 获取当前的垂直坐标。\r\n     */\r\n    endY: number;\r\n\r\n    /**\r\n     * 开始拖动的倒计时。\r\n     */\r\n    private _timer: number;\r\n\r\n    /**\r\n     * 当前正在拖动的对象。\r\n     */\r\n    static current?: Draggable;\r\n\r\n    /**\r\n     * 当前实际处理拖动鼠标移动的函数。可能是 start 或 dragMove。\r\n     */\r\n    private _handler: (e: MouseEvent) => void;\r\n\r\n    /**\r\n     * 是否禁止拖动。\r\n     * @param e 事件对象。\r\n     */\r\n    cancel(e: MouseEvent) {\r\n        return e.target !== this.handle && /^(?:input|textarea|button|select|option)/i.test((e.target as HTMLElement).tagName);\r\n    }\r\n\r\n    /**\r\n     * 处理指针按下事件。\r\n     * @param e 事件对象。\r\n     */\r\n    protected handlePointerDown(e: MouseEvent) {\r\n        if (e.which === 1 && !this.cancel(e)) {\r\n\r\n            // 禁用选区。\r\n            e.preventDefault();\r\n\r\n            // 不允许两个对象同时拖动。\r\n            if (Draggable.current) {\r\n                Draggable.current.stopDragging(e);\r\n            }\r\n\r\n            // 记录当前的开始位置。\r\n            this.endX = this.startX = e.pageX;\r\n            this.endY = this.startY = e.pageY;\r\n\r\n            // 设置下一步处理句柄。\r\n            this._handler = this.startDragging;\r\n\r\n            // 延时以避免将简单的点击作为拖动处理。\r\n            this._timer = this.delay >= 0 ? setTimeout(() => {\r\n                this._timer = 0;\r\n                this._handler(e);\r\n            }, this.delay) as any : -1;\r\n\r\n            // 绑定拖动和停止拖动事件。\r\n            const doc = this.handle.ownerDocument;\r\n            on(doc, \"pointerup\", this.handlePointerUp, this);\r\n            on(doc, \"pointermove\", this.handlePointerMove, this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 处理指针移动事件。\r\n     * @param e 事件对象。\r\n     */\r\n    protected handlePointerMove(e: MouseEvent) {\r\n\r\n        // 禁用选区。\r\n        e.preventDefault();\r\n\r\n        // 更新当前的鼠标位置。\r\n        this.endX = e.pageX;\r\n        this.endY = e.pageY;\r\n\r\n        // 调用当前的处理句柄来处理此函数。\r\n        this._handler(e);\r\n    }\r\n\r\n    /**\r\n     * 处理指针松开事件。\r\n     * @param e 事件对象。\r\n     */\r\n    protected handlePointerUp(e: MouseEvent) {\r\n        // 只有鼠标左键松开， 才认为是停止拖动。\r\n        if (e.which === 1) {\r\n            e.preventDefault();\r\n            this.stopDragging(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 拖动前鼠标样式。\r\n     */\r\n    private _orignalCursor: string | null;\r\n\r\n    /**\r\n     * 进入拖动状态。\r\n     * @param e 事件对象。\r\n     */\r\n    private startDragging(e: MouseEvent) {\r\n        // 进入拖动状态有两种可能：\r\n        // 1. 鼠标按下超时。\r\n        // 2. 鼠标按下然后移动超过一定距离。\r\n\r\n        // 如果 _timer 非 0 说明是通过移动鼠标进入。\r\n        if (this._timer) {\r\n            // 忽略移动距离太小的调用。\r\n            if ((this.endY - this.startY) ** 2 + (this.endX - this.startX) ** 2 < this.distance ** 2) {\r\n                return;\r\n            }\r\n            clearTimeout(this._timer);\r\n            this._timer = 0;\r\n        }\r\n\r\n        // 更新当前正在拖动的对象。\r\n        Draggable.current = this;\r\n\r\n        // 锁定鼠标样式。\r\n        this._orignalCursor = document.documentElement.style.cursor;\r\n        document.documentElement.style.cursor = getStyle(this.handle, \"cursor\");\r\n        if (\"pointerEvents\" in document.body.style) {\r\n            document.body.style.pointerEvents = \"none\";\r\n        } else if ((document.body as any).setCapture) {\r\n            (document.body as any).setCapture();\r\n        }\r\n\r\n        // 执行开始拖动回调，如果用户阻止和强制停止拖动。\r\n        if (this.dragStart(e) !== false) {\r\n            this._handler = this.dragMove;\r\n            this.dragMove(e);\r\n        } else {\r\n            this.stopDragging(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 退出拖动状态。\r\n     * @param e 事件对象。\r\n     */\r\n    private stopDragging(e: MouseEvent) {\r\n\r\n        // 解绑全局指针松开事件。\r\n        const doc = this.handle.ownerDocument;\r\n        off(doc, \"pointermove\", this.handlePointerMove, this);\r\n        off(doc, \"pointerup\", this.handlePointerUp, this);\r\n\r\n        // 清空计时器。\r\n        if (this._timer) {\r\n            clearTimeout(this._timer);\r\n            this._timer = 0;\r\n        }\r\n\r\n        // 如果在停止拖动时仍未开始拖动则作为点击事件触发。\r\n        if (this._handler === this.startDragging && this.onDragCancel) {\r\n            this.onDragCancel(e, this);\r\n        }\r\n\r\n        // 拖动结束。\r\n        if (Draggable.current === this) {\r\n\r\n            // 恢复鼠标样式。\r\n            if (document.body.style.pointerEvents === \"none\") {\r\n                document.body.style.pointerEvents = \"\";\r\n            } else if ((document.body as any).releaseCapture)\r\n                (document.body as any).releaseCapture();\r\n            document.documentElement.style.cursor = this._orignalCursor;\r\n\r\n            this.dragEnd(e);\r\n            Draggable.current = undefined;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 开始拖动时的水平偏移距离。\r\n     */\r\n    startClientX: number;\r\n\r\n    /**\r\n     * 开始拖动时的垂直偏移距离。\r\n     */\r\n    startClientY: number;\r\n\r\n    /**\r\n     * 当前的水平偏移距离。\r\n     */\r\n    endClientX: number;\r\n\r\n    /**\r\n     * 当前的垂直偏移距离。\r\n     */\r\n    endClientY: number;\r\n\r\n    /**\r\n     * 触发拖动开始事件。\r\n     * @param e 事件对象。\r\n     * @return 如果返回 false 则忽略本次拖动。\r\n     */\r\n    protected dragStart(e: MouseEvent) {\r\n        if (this.onDragStart && this.onDragStart(e, this) === false) {\r\n            return false;\r\n        }\r\n        const offset = getOffset(this.elem);\r\n        this.endClientX = this.startClientX = offset.x;\r\n        this.endClientY = this.startClientY = offset.y;\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 触发拖动移动事件。\r\n     * @param e 事件对象。\r\n     */\r\n    protected dragMove(e: MouseEvent) {\r\n        this.endClientX = this.startClientX + this.endX - this.startX;\r\n        this.endClientY = this.startClientY + this.endY - this.startY;\r\n        if (!this.onDragMove || this.onDragMove(e, this) !== false) {\r\n            this.elem.style.top = this.endClientY + \"px\";\r\n            this.elem.style.left = this.endClientX + \"px\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 触发拖动结束事件。\r\n     * @param e 事件对象。\r\n     */\r\n    protected dragEnd(e: MouseEvent) {\r\n        this.onDragEnd && this.onDragEnd(e, this);\r\n    }\r\n\r\n    /**\r\n     * 自动滚动屏幕。\r\n     * @param scrollable 滚动的容器元素。\r\n     * @param padding 判断是否在区域内的最小距离。\r\n     * @param offset 如果需要滚动则额外偏移的距离。\r\n     */\r\n    autoScroll(scrollable?: HTMLElement | Document, padding?: number, offset?: number) {\r\n        scrollIntoViewIfNeeded(this.elem, scrollable, 0, padding, offset);\r\n    }\r\n\r\n    /**\r\n     * 限制拖动的方向。\r\n     * @param value 要设置的方向。\r\n     */\r\n    direction(value: \"vertical\" | \"horizontal\") {\r\n        this[value === \"vertical\" ? \"endClientX\" : \"endClientY\"] = this[value === \"vertical\" ? \"startClientX\" : \"startClientY\"];\r\n    }\r\n\r\n    /**\r\n     * 限制只能在指定区域内拖动。\r\n     * @param container 限制的区域或元素。\r\n     * @param padding 容器的内边距。\r\n     */\r\n    limit(container: Document | HTMLElement | Rect, padding = 0) {\r\n        container = (container as Document | HTMLElement).nodeType ? getRect(container as Document | HTMLElement) : container as Rect;\r\n        this.elem.style.top = this.endClientY + \"px\";\r\n        this.elem.style.left = this.endClientX + \"px\";\r\n        const currentRect = getRect(this.elem);\r\n        let delta: number;\r\n        if ((delta = currentRect.x - container.x - padding) <= 0 || (delta = currentRect.x + currentRect.width - container.x - container.width + padding) >= 0) {\r\n            this.endClientX -= delta;\r\n        }\r\n        if ((delta = currentRect.y - container.y - padding) <= 0 || (delta = currentRect.y + currentRect.height - container.y - container.height + padding) >= 0) {\r\n            this.endClientY -= delta;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置当前拖动的步长。\r\n     * @param value 拖动的步长。\r\n     */\r\n    step(value: number) {\r\n        this.endClientY = this.startClientY + Math.floor((this.endClientY - this.startClientY + value / 2) / value) * value;\r\n        this.endClientX = this.startClientX + Math.floor((this.endClientX - this.startClientX + value / 2) / value) * value;\r\n    }\r\n\r\n    /**\r\n     * 还原节点位置。\r\n     * @param duration 渐变的总毫秒数。\r\n     */\r\n    revert(duration?: number) {\r\n        this.disable();\r\n        animate(this.elem, {\r\n            left: this.startClientX,\r\n            top: this.startClientY,\r\n        }, () => {\r\n            this.enable();\r\n        }, duration);\r\n    }\r\n\r\n    /**\r\n     * 使当前元素吸附于目标位置。\r\n     * @param target 吸附的目标区域或元素。\r\n     * @param padding 容器的内边距。\r\n     * @param distance 吸附的最小距离，当距离小于这个值后产生吸附效果。\r\n     * @param position 吸附的位置。\r\n     * @return 如果未吸附成功则返回 0，如果水平吸附成功则返回 1，如果垂直吸附成功则返回 2，如果都吸附成功则返回 3。\r\n     */\r\n    snap(target: Document | HTMLElement | Rect, padding = 0, distance = 15, position: \"both\" | \"inside\" | \"outside\" = \"both\") {\r\n        target = (target as Document | HTMLElement).nodeType ? getRect(target as Document | HTMLElement) : target as Rect;\r\n        const inside = position !== \"outside\";\r\n        const outside = position !== \"inside\";\r\n\r\n        this.elem.style.top = this.endClientY + \"px\";\r\n        this.elem.style.left = this.endClientX + \"px\";\r\n        const rect = getRect(this.elem);\r\n\r\n        let result = 0;\r\n\r\n        let deltaX = distance;\r\n        if (inside) {\r\n            deltaX = target.x + padding - rect.x;\r\n            if (Math.abs(deltaX) >= distance) {\r\n                deltaX = target.x + target.width - padding - rect.x - rect.width;\r\n            }\r\n        }\r\n        if (Math.abs(deltaX) >= distance && outside) {\r\n            deltaX = target.x + padding - rect.x - rect.width;\r\n            if (Math.abs(deltaX) >= distance) {\r\n                deltaX = target.x + target.width - padding - rect.x;\r\n            }\r\n        }\r\n        if (Math.abs(deltaX) < distance) {\r\n            this.endClientX += deltaX;\r\n            result += 1;\r\n        }\r\n\r\n        let deltaY = distance;\r\n        if (inside) {\r\n            deltaY = target.y + padding - rect.y;\r\n            if (Math.abs(deltaY) >= distance) {\r\n                deltaY = target.y + target.height - padding - rect.y - rect.height;\r\n            }\r\n        }\r\n        if (Math.abs(deltaY) >= distance && outside) {\r\n            deltaY = target.y + padding - rect.y - rect.height;\r\n            if (Math.abs(deltaY) >= distance) {\r\n                deltaY = target.y + target.height - padding - rect.y;\r\n            }\r\n        }\r\n        if (Math.abs(deltaY) < distance) {\r\n            this.endClientY += deltaY;\r\n            result += 2;\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n}\r\n\r\nDraggable.prototype.delay = 500;\r\nDraggable.prototype.distance = 3;\r\n\r\n/**\r\n * 设置指定的元素可拖动。\r\n * @param elem 要拖动的元素。\r\n * @param options 拖动的选项。\r\n * @return 返回一个拖动对象。\r\n */\r\nexport default function draggable(elem: HTMLElement, options?: Partial<Draggable>) {\r\n    const position = getStyle(elem, \"position\");\r\n    if (!position || position === \"static\") {\r\n        elem.style.position = \"relative\";\r\n    }\r\n    const result = new Draggable();\r\n    result.handle = result.elem = elem;\r\n    Object.assign(result, options);\r\n    result.enable();\r\n    return result;\r\n}\r\n"],"mappings":"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"}