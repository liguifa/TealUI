{"version":3,"file":"preventMaskScroll.js","sourceRoot":"../../..","sources":["components/ux/preventMaskScroll/preventMaskScroll.ts"],"sourcesContent":["/**\r\n * preventMaskScroll \r\n * @statable\r\n */\r\n/**\r\n * createPreventMaskScroll\r\n * @fileOverview 阻止浮层滚动穿透问题\r\n * @param  {Element} maskContent 滚动内容容器，必须是指定overflow:scroll的元素\r\n * @param  {Element} maskLayer 滚动蒙版\r\n * ==================1===================\r\n * <div role=\"maskLayer\">\r\n *     <div role=\"maskContent\"></div>\r\n * </div>\r\n * ==================2===================\r\n * <div role=\"maskContent & maskLayer\"></div>\r\n * <div class=\"mask\"></div>\r\n * @example\r\n * var preventScroll = createPreventMaskScroll()\r\n */\r\nfunction createPreventMaskScroll (maskContent, maskLayer) {\r\n\r\n    maskLayer = maskLayer || maskContent;\r\n    var touchesStart = {};\r\n\r\n    var onTouchStart = function (e) {\r\n        touchesStart.x = e.targetTouches[0].pageX;\r\n        touchesStart.y = e.targetTouches[0].pageY;\r\n    }\r\n\r\n    var onTouchMove = function (e) {\r\n        var pageX = e.targetTouches[0].pageX;\r\n        var pageY = e.targetTouches[0].pageY;\r\n        var touchDiffY = pageY - touchesStart.y;\r\n        var isScrollBottom = touchDiffY < 0 && maskLayer.scrollHeight - maskLayer.scrollTop == maskLayer.offsetHeight;\r\n        var isScrollTop = touchDiffY > 0 && maskLayer.scrollTop <= 0;\r\n        if (isScrollBottom || isScrollTop) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    }\r\n\r\n    function bind () {\r\n        maskContent.addEventListener('touchstart', onTouchStart, false);\r\n        maskContent.addEventListener('touchmove', onTouchMove, false);\r\n    }\r\n\r\n    function unbind () {\r\n        maskContent.removeEventListener('touchstart', onTouchStart, false);\r\n        maskContent.removeEventListener('touchmove', onTouchMove, false);\r\n    }\r\n\r\n    return {\r\n        bind: bind,\r\n        unbind: unbind\r\n    }\r\n}\r\n\r\nmodule.exports = createPreventMaskScroll()\r\nmodule.exports.createPreventMaskScroll = createPreventMaskScroll\r\n"],"mappings":"AAAA;;;GAGG;AACH;;;;;;;;;;;;;;GAcG;AACH,iCAAkC,WAAW,EAAE,SAAS;IAEpD,SAAS,GAAG,SAAS,IAAI,WAAW,CAAC;IACrC,IAAI,YAAY,GAAG,EAAE,CAAC;IAEtB,IAAI,YAAY,GAAG,UAAU,CAAC;QAC1B,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QAC1C,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;IAC9C,CAAC,CAAA;IAED,IAAI,WAAW,GAAG,UAAU,CAAC;QACzB,IAAI,KAAK,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QACrC,IAAI,KAAK,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QACrC,IAAI,UAAU,GAAG,KAAK,GAAG,YAAY,CAAC,CAAC,CAAC;QACxC,IAAI,cAAc,GAAG,UAAU,GAAG,CAAC,IAAI,SAAS,CAAC,YAAY,GAAG,SAAS,CAAC,SAAS,IAAI,SAAS,CAAC,YAAY,CAAC;QAC9G,IAAI,WAAW,GAAG,UAAU,GAAG,CAAC,IAAI,SAAS,CAAC,SAAS,IAAI,CAAC,CAAC;QAC7D,EAAE,CAAC,CAAC,cAAc,IAAI,WAAW,CAAC,CAAC,CAAC;YAChC,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,CAAC,CAAC,eAAe,EAAE,CAAC;QACxB,CAAC;IACL,CAAC,CAAA;IAED;QACI,WAAW,CAAC,gBAAgB,CAAC,YAAY,EAAE,YAAY,EAAE,KAAK,CAAC,CAAC;QAChE,WAAW,CAAC,gBAAgB,CAAC,WAAW,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;IAClE,CAAC;IAED;QACI,WAAW,CAAC,mBAAmB,CAAC,YAAY,EAAE,YAAY,EAAE,KAAK,CAAC,CAAC;QACnE,WAAW,CAAC,mBAAmB,CAAC,WAAW,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;IACrE,CAAC;IAED,MAAM,CAAC;QACH,IAAI,EAAE,IAAI;QACV,MAAM,EAAE,MAAM;KACjB,CAAA;AACL,CAAC;AAED,MAAM,CAAC,OAAO,GAAG,uBAAuB,EAAE,CAAA;AAC1C,MAAM,CAAC,OAAO,CAAC,uBAAuB,GAAG,uBAAuB,CAAA"}