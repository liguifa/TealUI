{"version":3,"file":"messageBox.js","sourceRoot":"../../..","sources":["components/ui/messageBox/messageBox.tsx"],"sourcesContent":["import * as dom from \"ux/dom\";\r\nimport Control, { VNode, bind } from \"ui/control\";\r\nimport Dialog from \"ui/dialog\";\r\nimport \"typo/util\";\r\nimport \"ui/textBox/textBox.scss\";\r\nimport \"ui/button/button.scss\";\r\nimport \"./messageBox.scss\";\r\n\r\n/**\r\n * 表示一个消息框。\r\n */\r\nexport default class MessageBox extends Dialog {\r\n\r\n    /**\r\n     * 当点击关闭按钮后执行。\r\n     */\r\n    protected handleCloseClick() {\r\n        this.cancel();\r\n    }\r\n\r\n    /**\r\n     * 点击确定按钮。\r\n     */\r\n    ok() {\r\n        if (!this.onOk || this.onOk() !== false) {\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 点击取消按钮。\r\n     */\r\n    cancel() {\r\n        if (!this.onCancel || this.onCancel() !== false) {\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 点击确定事件。\r\n     */\r\n    onOk: () => boolean | void;\r\n\r\n    /**\r\n     * 点击取消事件。\r\n     */\r\n    onCancel: () => boolean | void;\r\n\r\n    /**\r\n     * 图标。\r\n     */\r\n    set icon(value: \"error\" | \"warning\" | \"info\" | \"success\" | \"confirm\" | null) {\r\n        let icon = dom.prev(this.body, \".x-panel-icon\");\r\n        if (value) {\r\n            (icon || (icon = dom.before(this.body, \"<span/>\") as HTMLElement)).className = `x-icon x-panel-icon x-panel-icon-${value}`;\r\n        } else {\r\n            dom.remove(icon);\r\n        }\r\n    }\r\n\r\n    /**\r\n\t * 按钮。\r\n\t */\r\n    set buttons(value: { [content: string]: boolean | (() => void) } | null) {\r\n        let buttons = dom.next(this.body, \".x-panel-buttons\");\r\n        if (value === null) {\r\n            dom.remove(buttons);\r\n        } else {\r\n            if (buttons) {\r\n                buttons.innerHTML = \"\";\r\n            } else {\r\n                buttons = dom.append(dom.find(this.elem, \".x-panel\")!, `<div class=\"x-panel-buttons\"></div>`) as HTMLElement;\r\n            }\r\n            for (const key in value) {\r\n                const click = value[key];\r\n                const button = dom.append(buttons, `<button class=\"x-button\"></button>`) as HTMLButtonElement;\r\n                dom.setText(button, key);\r\n                if (click === true) {\r\n                    dom.addClass(button, \"x-button-primary\");\r\n                }\r\n                dom.on(button, \"click\", click === true ? this.ok : click === false ? this.cancel : click, this);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 主按钮。\r\n     */\r\n    set primaryButton(value: number) {\r\n        const old = dom.find(this.elem, \".x-dialog-buttons > .x-button-primary\");\r\n        if (old) {\r\n            dom.removeClass(old, \"x-button-primary\");\r\n        }\r\n        const btn = dom.find(this.elem, `.x-dialog-buttons > .x-button:nth-child(${value + 1})`);\r\n        if (btn) {\r\n            dom.addClass(btn, \"x-button-primary\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示一个消息框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param buttons 消息框的按钮。\r\n     * @param icon 消息框的图标。\r\n     * @param onOk 点击确定事件。\r\n     * @param onCancel 点击取消事件。\r\n     */\r\n    static show(content: MessageBox[\"content\"], title: MessageBox[\"title\"] = \"提示\", buttons: MessageBox[\"buttons\"] = { 确定: true }, icon?: MessageBox[\"icon\"], onOk?: MessageBox[\"onOk\"], onCancel?: MessageBox[\"onCancel\"]) {\r\n        const result = new MessageBox();\r\n        result.content = content;\r\n        result.title = title;\r\n        result.draggable = true;\r\n        result.buttons = buttons;\r\n        result.icon = icon!;\r\n        result.onOk = onOk!;\r\n        result.onCancel = onCancel!;\r\n        result.show();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 显示一个警告框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param onOk 点击确定事件。\r\n     */\r\n    static alert(content: MessageBox[\"content\"], title: MessageBox[\"title\"] = \"警告\", onOk?: MessageBox[\"onOk\"]) {\r\n        return MessageBox.show(content, title, undefined, \"warning\", onOk, onOk);\r\n    }\r\n\r\n    /**\r\n     * 显示一个确认框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param onOk 点击确定事件。\r\n     * @param onCancel 点击取消事件。\r\n     */\r\n    static confirm(content: MessageBox[\"content\"], title: MessageBox[\"title\"] = \"确认\", onOk?: MessageBox[\"onOk\"], onCancel?: MessageBox[\"onCancel\"]) {\r\n        const result = MessageBox.show(content, title, {\r\n            \"确定\": true,\r\n            \"取消\": false\r\n        }, \"confirm\", onOk, onCancel);\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 显示一个输入框。\r\n     * @param content 消息框的内容。\r\n     * @param title 消息框的标题。\r\n     * @param onOk 点击确定事件。\r\n     * @param onCancel 点击取消事件。\r\n     */\r\n    static prompt(content: string, title: MessageBox[\"title\"] = \"请输入\", onOk?: (value: string) => boolean | void, onCancel?: MessageBox[\"onCancel\"]) {\r\n        const result = MessageBox.show(`<input type=\"text\" class=\"x-textbox x-block\">`, title, {\r\n            \"确定\": true,\r\n            \"取消\": false\r\n        }, undefined, () => {\r\n            onOk && onOk.call(result, (result.find(\".x-textbox\") as HTMLInputElement).value);\r\n        }, onCancel);\r\n        (result.find(\".x-textbox\") as HTMLInputElement).value = content;\r\n        return result;\r\n    }\r\n\r\n}\r\n"],"mappings":";;IAQA;;OAEG;IACH,gBAAgC,SAAQ,gBAAM;QAE1C;;WAEG;QACO,gBAAgB;YACtB,IAAI,CAAC,MAAM,EAAE,CAAC;QAClB,CAAC;QAED;;WAEG;QACH,EAAE;YACE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE,KAAK,KAAK,CAAC,CAAC,CAAC;gBACtC,IAAI,CAAC,KAAK,EAAE,CAAC;YACjB,CAAC;QACL,CAAC;QAED;;WAEG;QACH,MAAM;YACF,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,EAAE,KAAK,KAAK,CAAC,CAAC,CAAC;gBAC9C,IAAI,CAAC,KAAK,EAAE,CAAC;YACjB,CAAC;QACL,CAAC;QAYD;;WAEG;QACH,IAAI,IAAI,CAAC,KAAkE;YACvE,IAAI,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC;YAChD,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACR,CAAC,IAAI,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,SAAS,CAAgB,CAAC,CAAC,CAAC,SAAS,GAAG,oCAAoC,KAAK,EAAE,CAAC;YAC/H,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YACrB,CAAC;QACL,CAAC;QAED;;WAEA;QACA,IAAI,OAAO,CAAC,KAA2D;YACnE,IAAI,OAAO,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,kBAAkB,CAAC,CAAC;YACtD,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;gBACjB,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACxB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;oBACV,OAAO,CAAC,SAAS,GAAG,EAAE,CAAC;gBAC3B,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACJ,OAAO,GAAG,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU,CAAE,EAAE,qCAAqC,CAAgB,CAAC;gBACjH,CAAC;gBACD,GAAG,CAAC,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC;oBACtB,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;oBACzB,MAAM,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,OAAO,EAAE,oCAAoC,CAAsB,CAAC;oBAC9F,GAAG,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;oBACzB,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;wBACjB,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,kBAAkB,CAAC,CAAC;oBAC7C,CAAC;oBACD,GAAG,CAAC,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,KAAK,KAAK,IAAI,GAAG,IAAI,CAAC,EAAE,GAAG,KAAK,KAAK,KAAK,GAAG,IAAI,CAAC,MAAM,GAAG,KAAK,EAAE,IAAI,CAAC,CAAC;gBACpG,CAAC;YACL,CAAC;QACL,CAAC;QAED;;WAEG;QACH,IAAI,aAAa,CAAC,KAAa;YAC3B,MAAM,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,uCAAuC,CAAC,CAAC;YACzE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;gBACN,GAAG,CAAC,WAAW,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;YAC7C,CAAC;YACD,MAAM,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,2CAA2C,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC;YACzF,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;gBACN,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;YAC1C,CAAC;QACL,CAAC;QAED;;;;;;;;WAQG;QACH,MAAM,CAAC,IAAI,CAAC,OAA8B,EAAE,QAA6B,IAAI,EAAE,UAAiC,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,IAAyB,EAAE,IAAyB,EAAE,QAAiC;YACjN,MAAM,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;YAChC,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC;YACzB,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;YACrB,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;YACxB,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC;YACzB,MAAM,CAAC,IAAI,GAAG,IAAK,CAAC;YACpB,MAAM,CAAC,IAAI,GAAG,IAAK,CAAC;YACpB,MAAM,CAAC,QAAQ,GAAG,QAAS,CAAC;YAC5B,MAAM,CAAC,IAAI,EAAE,CAAC;YACd,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;QAED;;;;;WAKG;QACH,MAAM,CAAC,KAAK,CAAC,OAA8B,EAAE,QAA6B,IAAI,EAAE,IAAyB;YACrG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAC7E,CAAC;QAED;;;;;;WAMG;QACH,MAAM,CAAC,OAAO,CAAC,OAA8B,EAAE,QAA6B,IAAI,EAAE,IAAyB,EAAE,QAAiC;YAC1I,MAAM,MAAM,GAAG,UAAU,CAAC,IAAI,CAAC,OAAO,EAAE,KAAK,EAAE;gBAC3C,IAAI,EAAE,IAAI;gBACV,IAAI,EAAE,KAAK;aACd,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;YAC9B,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;QAED;;;;;;WAMG;QACH,MAAM,CAAC,MAAM,CAAC,OAAe,EAAE,QAA6B,KAAK,EAAE,IAAwC,EAAE,QAAiC;YAC1I,MAAM,MAAM,GAAG,UAAU,CAAC,IAAI,CAAC,+CAA+C,EAAE,KAAK,EAAE;gBACnF,IAAI,EAAE,IAAI;gBACV,IAAI,EAAE,KAAK;aACd,EAAE,SAAS,EAAE;gBACV,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAsB,CAAC,KAAK,CAAC,CAAC;YACrF,CAAC,EAAE,QAAQ,CAAC,CAAC;YACZ,MAAM,CAAC,IAAI,CAAC,YAAY,CAAsB,CAAC,KAAK,GAAG,OAAO,CAAC;YAChE,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;KAEJ;IAzJD,6BAyJC"}