{"version":3,"file":"input.js","sourceRoot":"../../..","sources":["components/ui/input/input.tsx"],"sourcesContent":["import * as dom from \"ux/dom\";\r\nimport Control, { VNode, bind } from \"ui/control\";\r\nimport { Status, getStatus, setStatus } from \"ux/status\";\r\nimport ToolTip from \"ui/toolTip\";\r\n\r\n/**\r\n * 表示一个输入控件。\r\n */\r\nexport default class Input extends Control {\r\n\r\n    protected render() {\r\n        return <input type=\"hidden\" />;\r\n    }\r\n\r\n    /**\r\n     * 获取真正存储输入值的 HTML 元素。\r\n     */\r\n    get input() {\r\n        return (dom.find(this.elem, \"input,select,textarea\") || this.elem) as HTMLInputElement;\r\n    }\r\n\r\n    /**\r\n     * 字段名。\r\n     */\r\n    @bind(\"@input\", \"name\") name: string;\r\n\r\n    /**\r\n     * 字段值。\r\n     */\r\n    get value() { return this.input.value as any; }\r\n    set value(value) {\r\n        this.input.value = value;\r\n        if (!this.hasOwnProperty(\"defaultValue\")) {\r\n            this.defaultValue = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 默认值。\r\n     */\r\n    defaultValue: this[\"value\"];\r\n\r\n    /**\r\n     * 输入框的类型。\r\n     */\r\n    @bind(\"@input\", \"type\") type: string;\r\n\r\n    /**\r\n     * 未输入内容时的占位符。\r\n     */\r\n    @bind(\"@input\", \"placeholder\") placeholder: string;\r\n\r\n    /**\r\n     * 是否禁用。\r\n     */\r\n    @bind(\"@input\", \"disabled\") disabled: boolean;\r\n\r\n    /**\r\n     * 是否只读。\r\n     */\r\n    @bind(\"@input\", \"readOnly\") readOnly: boolean;\r\n\r\n    /**\r\n     * 复制事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/oncopy\r\n     */\r\n    @bind(\"@input\", \"onCopy\") onCopy: (e: ClipboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 剪切事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/oncut\r\n     */\r\n    @bind(\"@input\", \"onCut\") onCut: (e: ClipboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 粘贴事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onpaste\r\n     */\r\n    @bind(\"@input\", \"onPaste\") onPaste: (e: ClipboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 即将复制事件。\r\n     * @see https://msdn.microsoft.com/zh-cn/library/aa769320.ASPX\r\n     */\r\n    @bind(\"@input\", \"onBeforeCopy\") onBeforeCopy: (e: ClipboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 即将剪切事件。\r\n     * @see https://msdn.microsoft.com/zh-cn/library/aa769321.aspx\r\n     */\r\n    @bind(\"@input\", \"onBeforeCut\") onBeforeCut: (e: ClipboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 即将粘贴事件。\r\n     * @see https://msdn.microsoft.com/zh-cn/library/aa769324.aspx\r\n     */\r\n    @bind(\"@input\", \"onBeforePaste\") onBeforePaste: (e: ClipboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 获取焦点事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/nfocus\r\n     */\r\n    @bind(\"@input\", \"onFocus\") onFocus: (e: FocusEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 失去焦点事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onblur\r\n     */\r\n    @bind(\"@input\", \"onBlur\") onBlur: (e: FocusEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 当前元素和子元素获取焦点事件。\r\n     * @see https://msdn.microsoft.com/zh-CN/library/ms536935(VS.85).aspx\r\n     */\r\n    @bind(\"@input\", \"onFocusIn\") onFocusIn: (e: FocusEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 当前元素和子元素失去焦点事件。\r\n     * @see https://msdn.microsoft.com/zh-CN/library/ms536936(VS.85).aspx\r\n     */\r\n    @bind(\"@input\", \"onFocusOut\") onFocusOut: (e: FocusEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 输入事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/oninput\r\n     */\r\n    @bind(\"@input\", \"onInput\") onInput: (e: Event, sender: this) => void;\r\n\r\n    /**\r\n     * 更改事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlersonchange\r\n     */\r\n    @bind(\"@input\", \"onChange\") onChange: (e: Event, sender: this) => void;\r\n\r\n    /**\r\n     * 键盘按下事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onkeydown\r\n     */\r\n    @bind(\"@input\", \"onKeyDown\") onKeyDown: (e: KeyboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 键盘点击事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onkeypress\r\n     */\r\n    @bind(\"@input\", \"onKeyPress\") onKeyPress: (e: KeyboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 键盘按上事件。\r\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/GlobalEventHandlers/onkeyup\r\n     */\r\n    @bind(\"@input\", \"onKeyUp\") onKeyUp: (e: KeyboardEvent, sender: this) => void;\r\n\r\n    /**\r\n     * 控件状态。\r\n     */\r\n    get status() {\r\n        return getStatus(this.input, this.statusClassPrefix);\r\n    }\r\n    set status(value) {\r\n        setStatus(this.input, this.statusClassPrefix, value);\r\n    }\r\n\r\n    /**\r\n     * 控件状态前缀。\r\n     */\r\n    statusClassPrefix: string;\r\n\r\n    /**\r\n     * 触发验证的事件。\r\n     */\r\n    validateEvent: string | null;\r\n\r\n    /**\r\n     * 是否禁用验证。\r\n     */\r\n    noValidate: boolean;\r\n\r\n    /**\r\n     * 字段是否必填。\r\n     */\r\n    required: boolean;\r\n\r\n    /**\r\n     * 字段不满足必填时的提示文案。\r\n     */\r\n    requiredMessage: string;\r\n\r\n    /**\r\n     * 最大长度。-1 表示不限制。\r\n     */\r\n    maxLength: number;\r\n\r\n    /**\r\n     * 字段不满足最大长度时的提示文案。\r\n     */\r\n    maxLengthMessage: string;\r\n\r\n    /**\r\n     * 最小长度。-1 表示不限制。\r\n     */\r\n    minLength: number;\r\n\r\n    /**\r\n     * 字段不满足最小长度时的提示文案。\r\n     */\r\n    minLengthMessage: string;\r\n\r\n    /**\r\n     * 最大值。\r\n     */\r\n    max: any;\r\n\r\n    /**\r\n     * 字段不满足最大值时的提示文案。\r\n     */\r\n    maxMessage: string;\r\n\r\n    /**\r\n     * 最小值。\r\n     */\r\n    min: any;\r\n\r\n    /**\r\n     * 字段不满足最小值时的提示文案。\r\n     */\r\n    minMessage: string;\r\n\r\n    /**\r\n     * 匹配格式的正则表达式。\r\n     */\r\n    pattern: RegExp;\r\n\r\n    /**\r\n     * 字段不满足格式时的提示文案。\r\n     */\r\n    patternMessage: string;\r\n\r\n    /**\r\n     * 验证失败的提示文案。\r\n     */\r\n    validateErrorMessage: string;\r\n\r\n    /**\r\n     * 开始异步验证的提示文案。\r\n     */\r\n    validateStartMessage: string;\r\n\r\n    /**\r\n     * 异步验证失败的提示文案。\r\n     */\r\n    validateFailMessage: string;\r\n\r\n    /**\r\n     * 验证信息状态的提示文案前缀。\r\n     */\r\n    validateInfoMessagePrefix: string;\r\n\r\n    /**\r\n     * 验证失败状态的提示文案前缀。\r\n     */\r\n    validateErrorMessagePrefix: string;\r\n\r\n    /**\r\n     * 验证警告状态的提示文案前缀。\r\n     */\r\n    validateWarningMessagePrefix: string;\r\n\r\n    /**\r\n     * 验证成功状态的提示文案前缀。\r\n     */\r\n    validateSuccessMessagePrefix: string;\r\n\r\n    /**\r\n     * 本地化提示文案。\r\n     */\r\n    static locale = {\r\n        requiredMessage: `该字段为必填的`,\r\n        maxLengthMessage: `该字段最大长度为 {bound}，超出 {delta}`,\r\n        minLengthMessage: `该字段最少长度为 {bound}，缺少 {delta}`,\r\n        maxMessage: `该字段最大为 {bound}`,\r\n        minMessage: `该字段最小为 {bound}`,\r\n        patternMessage: `该字段格式不正确`,\r\n        validateErrorMessage: `该字段存在错误`,\r\n        validateStartMessage: `<i class=\"x-icon x-spin\">҉</i> 正在验证中...`,\r\n        validateFailMessage: `无法验证：{reason}`,\r\n        validateInfoMessagePrefix: `<i class=\"x-icon\">🛈</i> `,\r\n        validateSuccessMessagePrefix: `<i class=\"x-icon\">✓</i> `,\r\n        validateWarningMessagePrefix: `<i class=\"x-icon\">⚠</i> `,\r\n        validateErrorMessagePrefix: `<i class=\"x-icon\">&#10071;</i> `\r\n    };\r\n\r\n    /**\r\n     * 判断当前输入域是否需要验证。\r\n     */\r\n    get willValidate() {\r\n        if (this.noValidate || this.readOnly || this.disabled || this.hidden) {\r\n            return false;\r\n        }\r\n        if (this.onValidate || this.required || this.maxLength >= 0 || this.minLength >= 0 || this.max != null || this.min != null || this.pattern || this.validate !== Input.prototype.validate) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    protected init() {\r\n        if (this.validateEvent) {\r\n            dom.on(this.input, this.validateEvent, this.handleValidate, this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 验证事件触发后延时验证的毫秒数。\r\n     */\r\n    validateDelay: number;\r\n\r\n    /**\r\n     * 重新验证事件触发后延时验证的毫秒数。\r\n     */\r\n    revalidateDelay: number;\r\n\r\n    /**\r\n     * 如果使用了延时验证则存储延时计时器。\r\n     */\r\n    private _validateTimer: any;\r\n\r\n    /**\r\n     * 处理验证字段。\r\n     */\r\n    protected handleValidate() {\r\n        if (this.validateEvent) {\r\n            const delay = this.status === \"error\" ? this.revalidateDelay : this.validateDelay;\r\n            if (delay) {\r\n                if (this._validateTimer) clearTimeout(this._validateTimer);\r\n                this._validateTimer = setTimeout(() => {\r\n                    delete this._validateTimer;\r\n                    this.reportValidity();\r\n                }, delay);\r\n            } else {\r\n                this.reportValidity();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 验证当前输入域。\r\n     * @return 返回验证结果。如果正在执行异步验证则返回一个确认对象。\r\n     */\r\n    checkValidity(): NormalizedValidityResult | Promise<NormalizedValidityResult> {\r\n\r\n        // 测试是否已填数据。\r\n        const value = this.value;\r\n        if (value == null || value.length === 0 && (typeof value === \"string\" || Array.isArray(value))) {\r\n            if (this.required) {\r\n                return { valid: false, status: \"error\", message: this.requiredMessage };\r\n            }\r\n            return { valid: true, status: null };\r\n        }\r\n\r\n        // 执行内置验证。\r\n        const result = this.normlizeValidityResult(this.validate(value));\r\n        if (result instanceof Promise) {\r\n            return result.then(result => {\r\n                if (!result.valid) {\r\n                    return result;\r\n                }\r\n\r\n                // 执行自定义验证。\r\n                if (this.onValidate) {\r\n                    return this.normlizeValidityResult(this.onValidate(value, this));\r\n                }\r\n\r\n                // 验证成功。\r\n                return result;\r\n            });\r\n        }\r\n\r\n        if (!result.valid) {\r\n            return result;\r\n        }\r\n\r\n        // 执行自定义验证。\r\n        if (this.onValidate) {\r\n            return this.normlizeValidityResult(this.onValidate(value, this));\r\n        }\r\n\r\n        // 验证成功。\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 当被子类重写时负责验证指定的值。\r\n     * @param value 要验证的值。\r\n     * @return 返回验证结果。如果正在执行异步验证则返回一个确认对象。\r\n     */\r\n    protected validate(value: this[\"value\"]): ValidityResult {\r\n        if (this.maxLength >= 0 && (value as any).length > this.maxLength) {\r\n            return this.maxLengthMessage.replace(\"{bound}\", this.maxLength as any).replace(\"{delta}\", ((value as any).length - this.maxLength) as any);\r\n        }\r\n        if (this.minLength >= 0 && (value as any).length < this.minLength) {\r\n            return this.minLengthMessage.replace(\"{bound}\", this.minLength as any).replace(\"{delta}\", (this.minLength - (value as any).length) as any);\r\n        }\r\n        if (this.max != null && value > this.max) {\r\n            return this.maxMessage.replace(\"{bound}\", this.max as any);\r\n        }\r\n        if (this.min != null && value < this.min) {\r\n            return this.minMessage.replace(\"{bound}\", this.min);\r\n        }\r\n        if (this.pattern && !this.pattern.test(value)) {\r\n            return this.patternMessage.replace(\"{bound}\", this.pattern as any);\r\n        }\r\n        return \"\";\r\n    }\r\n\r\n    /**\r\n     * 验证事件。\r\n     * @param value 要验证的值。\r\n     * @param sender 触发事件的源。\r\n     * @return 返回验证结果。如果正在执行异步验证则返回一个确认对象。\r\n     */\r\n    onValidate: (value: this[\"value\"], sender: this) => ValidityResult;\r\n\r\n    /**\r\n     * 规范化验证结果对象。\r\n     * @param result 用户返回的验证结果。\r\n     * @param 返回已格式化的验证结果。\r\n     */\r\n    protected normlizeValidityResult(result: ValidityResult): NormalizedValidityResult | Promise<NormalizedValidityResult> {\r\n        if (result instanceof Promise) {\r\n            return result.then(r => this.normlizeValidityResult(r));\r\n        }\r\n        if (typeof result === \"boolean\") {\r\n            result = result ? \"\" : this.validateErrorMessage;\r\n        }\r\n        if (typeof result === \"string\") {\r\n            return {\r\n                valid: !result,\r\n                status: result ? \"error\" : \"success\",\r\n                message: result ? this.validateErrorMessagePrefix + result : \"\",\r\n            };\r\n        }\r\n        if (result.valid == undefined) {\r\n            result.valid = !result.status || result.status === \"success\";\r\n        }\r\n        return result as NormalizedValidityResult;\r\n    }\r\n\r\n    /**\r\n     * 向用户报告验证结果。\r\n     * @param hideSuccess 是否隐藏验证成功状态。\r\n     * @return 返回验证结果。如果正在执行异步验证则返回一个确认对象。\r\n     */\r\n    reportValidity(hideSuccess = this.hideSuccess) {\r\n        const result = this.willValidate ? this.checkValidity() : { valid: true };\r\n        if (result instanceof Promise) {\r\n            if (!this._validatePromise) {\r\n                this.setCustomValidity({ valid: false, status: \"warning\", message: this.validateStartMessage }, hideSuccess);\r\n            }\r\n            const promise = this._validatePromise = result.then(result => {\r\n                if (this._validatePromise === promise) {\r\n                    delete this._validatePromise;\r\n                    this.setCustomValidity(result, hideSuccess);\r\n                }\r\n                return result;\r\n            }, (reason: string) => {\r\n                const result = { valid: false, status: \"error\", message: this.validateFailMessage.replace(\"{reason}\", reason) } as NormalizedValidityResult;\r\n                if (this._validatePromise === promise) {\r\n                    delete this._validatePromise;\r\n                    this.setCustomValidity(result, hideSuccess);\r\n                }\r\n                return result;\r\n            });\r\n            return promise;\r\n        }\r\n        this.setCustomValidity(result, hideSuccess);\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 存储最后一次确认对象。\r\n     */\r\n    private _validatePromise: Promise<NormalizedValidityResult>;\r\n\r\n    /**\r\n     * 是否隐藏验证成功状态。\r\n     */\r\n    hideSuccess: boolean;\r\n\r\n    /**\r\n     * 设置自定义的验证消息。\r\n     * @param validityResult 要报告的验证结果。\r\n     * @param hideSuccess 是否隐藏验证成功状态。\r\n     */\r\n    setCustomValidity(validityResult: string | boolean | Partial<NormalizedValidityResult>, hideSuccess = this.hideSuccess) {\r\n\r\n        // 统一验证结果数据格式。\r\n        validityResult = this.normlizeValidityResult(validityResult) as NormalizedValidityResult;\r\n        if (hideSuccess && validityResult.status === \"success\") {\r\n            validityResult = { valid: validityResult.valid, status: null, message: validityResult.message };\r\n        }\r\n\r\n        // 更新状态。\r\n        this.status = (validityResult as NormalizedValidityResult).status;\r\n\r\n        // 自定义错误报告。\r\n        if (this.onReportValidity && this.onReportValidity(validityResult as NormalizedValidityResult, this) === false) {\r\n            return;\r\n        }\r\n\r\n        // 提示验证信息。\r\n        const tip = dom.next(this.elem, \".x-tip,.x-tipbox\");\r\n        if (tip) {\r\n            setStatus(tip, dom.hasClass(tip, \"x-tipbox\") ? \"x-tipbox-\" : \"x-tip-\", this.status);\r\n            dom.toggle(tip, !!validityResult.message);\r\n            tip.innerHTML = validityResult.message!;\r\n        } else {\r\n            let validityToolTip = this._validityToolTip;\r\n            if (validityResult.message) {\r\n                if (!validityToolTip) {\r\n                    this._validityToolTip = validityToolTip = this.createValidityToolTip();\r\n                }\r\n                const arrow = dom.first(validityToolTip.elem, \".x-arrow\");\r\n                validityToolTip.elem.innerHTML = validityResult.message!;\r\n                if (arrow) dom.prepend(validityToolTip.elem, arrow);\r\n                validityToolTip.show();\r\n            } else if (validityToolTip) {\r\n                validityToolTip.hide();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 验证工具提示的选项。\r\n     */\r\n    validityToolTipOptions: Partial<ToolTip>;\r\n\r\n    /**\r\n     * 当被子类重写时负责创建当前输入框的默认验证提示。\r\n     */\r\n    protected createValidityToolTip() {\r\n        const validityToolTip = new ToolTip();\r\n        validityToolTip.event = \"focusin\";\r\n        validityToolTip.animation = \"zoomIn\";\r\n        validityToolTip.autoHide = false;\r\n        validityToolTip.onShow = () => {\r\n            if (!this.status || this.status === \"success\") {\r\n                this._validityToolTip.hide();\r\n            }\r\n        };\r\n        validityToolTip.target = this.elem;\r\n        Object.assign(validityToolTip, this.validityToolTipOptions);\r\n        dom.after(this.elem, validityToolTip.elem);\r\n        return validityToolTip;\r\n    }\r\n\r\n    /**\r\n     * 用于报告验证失败的工具提示。\r\n     */\r\n    private _validityToolTip: ToolTip;\r\n\r\n    /**\r\n     * 报告验证结果事件。\r\n     * @param validityResult 要报告的验证结果。\r\n     * @param sender 触发事件的源。\r\n     * @return 返回 false 禁用默认报告器。\r\n     */\r\n    onReportValidity: (validityResult: NormalizedValidityResult, sender: this) => boolean | void;\r\n\r\n    /**\r\n     * 重置当前输入域。\r\n     */\r\n    reset() {\r\n        this.setCustomValidity({ valid: true, status: null });\r\n        this.value = this.defaultValue;\r\n    }\r\n\r\n    /**\r\n     * 令当前控件获得焦点。\r\n     */\r\n    focus() {\r\n        this.input.focus();\r\n    }\r\n\r\n    /**\r\n     * 令当前控件失去焦点。\r\n     */\r\n    blur() {\r\n        this.input.blur();\r\n    }\r\n}\r\n\r\nfor (const key in Input.locale) {\r\n    Input.prototype[key as keyof typeof Input[\"locale\"]] = Input.locale[key as keyof typeof Input[\"locale\"]];\r\n}\r\nInput.prototype.statusClassPrefix = \"x-\";\r\nInput.prototype.validateEvent = \"change\";\r\n\r\n/**\r\n * 表示验证的结果。\r\n */\r\nexport type ValidityResult = boolean | string | Partial<NormalizedValidityResult> | Promise<boolean | string | Partial<NormalizedValidityResult>>;\r\n\r\n/**\r\n * 表示已格式化的验证结果。\r\n */\r\nexport interface NormalizedValidityResult {\r\n\r\n    /**\r\n     * 验证是否通过。只有验证通过后数据才会提交。一般地仅当 *status* 为空或者 \"success\" 时才会验证通过。\r\n     */\r\n    valid: boolean;\r\n\r\n    /**\r\n     * 验证的结果状态。\r\n     */\r\n    status: Status;\r\n\r\n    /**\r\n     * 提示的信息。\r\n     */\r\n    message?: string;\r\n\r\n}\r\n"],"mappings":"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"}