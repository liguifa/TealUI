<!DOCTYPE html>
<html class="doc">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>treeView (2) - Frag | æœ€ä¸Šæµçš„ç»„ä»¶åº“</title>
    <link rel="shortcut icon" href="../../../../assets/doc/images/favicon.ico">
    <link rel="stylesheet" href="../../../../assets/doc/doc.css">
    <script src="../../../../components/require.js"></script>
	<script>require(["ui/treeView/old/treeView (2)"])</script>
</head>
<body>
    <header id="doc_header">
        <div class="doc-container">
            <h1 id="doc_logo">
                <a href="../../../../" title="Teal" id="doc_logo_image"><img src="../../../../assets/doc/images/logo.svg" alt="Frag"></a>
                <a href="../../../../" id="doc_logo_title">Frag</a>
                <div id="doc_version" class="doc-menubutton">
                    <a href="javascript://åˆ‡æ¢ç‰ˆæœ¬">4.0.0 <i class="doc-icon">â·</i></a>
                    <menu>
                        <li><a href="http://tealui.com/v3.x/" target="_blank">3.x</a></li>
                        <li><a href="http://tealui.com/v2.x/" target="_blank">2.x</a></li>
                    </menu>
                </div>
            </h1>
            <nav id="doc_navbar">
                <ul>
                    <li><a href="../../../../docs" title="æ–‡æ¡£å’Œè§„èŒƒ">æ–‡æ¡£</a></li>
                    <li class="doc-navbar-active"><a href="../../../../components" title="ç»„ä»¶å’Œæ¼”ç¤º">ç»„ä»¶</a></li>
                    <li><a href="../../../../tools" title="å·¥å…·å’Œèµ„æº">å·¥å…·</a></li>
                </ul>
                <a href="http://git.weidai.work/fed/frag" target="_blank" title="GitHub" id="doc_repository" class="doc-icon">ğŸ˜º</a>
                <a href="javascript:Doc.toggleSidebar()" title="èœå•" id="doc_togglesidebar" class="doc-icon">â‰¡</a>
            </nav>
        </div>
    </header>
    <div id="doc_body" class="doc-container">
        <aside id="doc_sidebar">
            <div id="doc_sidebar_header">
                <input type="search" placeholder="æŸ¥æ‰¾ç»„ä»¶..." autocomplete="off" id="doc_sidebar_filter">
            </div>
            <ul id="doc_sidebar_menu">
                <li class="doc-tip"><i class="doc-icon doc-spin">Ò‰</i> æ­£åœ¨è½½å…¥åˆ—è¡¨...</li>
            </ul>
        </aside>
        <article id="doc_main" class="doc">
<aside id="doc_mainmenu" class="doc-menubutton">
                            <a href="javascript://æ‰“å¼€å·¥å…·" title="å·¥å…·" class="doc-icon">ğŸ”§â·</a>
                            <menu>
                                
                                <li><a href="javascript:Doc.toggleFullScreen()" accesskey="f"><i class="doc-icon">âœ¥</i>å…¨å±æ˜¾ç¤º</a></li>
                                
                                <li><a href="javascript:Doc.toggleApis()" accesskey="a"><i class="doc-icon">â‰¡</i>å±•å¼€ API</a></li>
                                <li class="doc-menu-divider"><a href="http://git.weidai.work/fed/frag/tree/dev-v4/components/ui/treeView/old/treeView (2).ts" target="_blank"><i class="doc-icon">ğŸ˜º</i>æŸ¥çœ‹æºç </a></li>
                                <li><a href="http://git.weidai.work/fed/frag/issues/new?title=ui/treeView/old/treeView (2)" target="_blank"><i class="doc-icon">ğŸ›</i>æŠ¥å‘Š BUG</a></li>
                                <li><a href="http://git.weidai.work/fed/frag/edit/dev-v4/components/ui/treeView/old/treeView (2).md" target="_blank"><i class="doc-icon">âœ</i>ç¼–è¾‘æ­¤é¡µ</a></li>
                            </menu>
                        </aside>
                        <article><script type="text/html">
VNode.create("div", { id: "ct", style: "width:300px" }), (VNode.create("script", null,
    " var treeView = new TreeView(); treeView.renderTo('#ct'); var treeNode1 = treeView.add(\"1\"); treeNode1.add(\"1-1\"); treeNode1.add(\"1-2\"); var treeNode2 = treeView.add(\"2\"); ",
    VNode.create("", null),
    ">"), VNode.create("script", null,
    "Demo.writeExamples(",
    'æ·»åŠ ä¸€ä¸ªå­èŠ‚ç‚¹',
    " 'treeView.add(\"",
    VNode.create("em", null, "\u8FD9\u662F\u4F7F\u7528 add \u6DFB\u52A0\u7684"),
    "\")', '\u5728\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9\u540E\u4E0B\u4E00\u4E2A\u5B50\u8282\u70B9': 'treeView.item(0).add(\"1 \u540E\u7684\u5B50\u8282\u70B9\")', '\u5220\u9664\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9': 'treeView.removeAt(0)', '\u6298\u53E0\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9': 'treeView.collapse()', '\u5C55\u5F00\u786E\u4FDD\u7B2C\u4E00\u4E2A\u5B50\u8282\u70B9\u5185\u53EF\u89C1': 'treeView.item(0).ensureVisible()', '\u83B7\u53D6\u9009\u4E2D\u7684\u8282\u70B9': 'treeView.getSelectedNode()' });"));
</script></article>
                        <h2 id="api"><a href="#api" title="é“¾æ¥" aria-hidden="true" class="doc-icon doc-permalink">â˜</a>API</h2><div class="doc doc-scrollable"><table class="doc-api"><tr>
                                <th class="doc-api-property">å˜é‡</th>
                                <th class="doc-api-type">ç±»å‹</th>
                                <th class="doc-api-summary">æè¿°</th>
                                
                            </tr><tr id="api/TreeView">
                            <td>
                                <a href="http://git.weidai.work/fed/frag/tree/dev-v4/components/ui/treeView/old/treeView (2).ts#L11-123" target="_blank" title="æºç ï¼šui/treeView/old/treeView (2).tsï¼Œç¬¬ 11 è¡Œ" aria-hidden="true" class="doc-icon doc-sourcelink doc-api-more">â…</a>
                                <a href="javascript://è¯¦ç»†ä¿¡æ¯" title="å±•å¼€/æŠ˜å è¯¦ç»†ä¿¡æ¯" class="doc-icon doc-api-toggle" onclick="Doc.toggleApi(this)">â®</a>
                                <code>TreeView</code>
                                <span class="doc-api-more">: <code>any</code> = <code>TreeControl.extend({

    cssClass: 'x-treeview',

    depth: 0,

    createNode: function (exitsNode) {
    	return new TreeNode(exitsNode);
    },

    initChildNode: function (li) {
    	TreeControl.prototype.initChildNode.call(this, li);

		// æ›´æ–°å­èŠ‚ç‚¹çš„æ·±åº¦ã€‚
    	this.itemOf(li).setDepth(this.depth + 1);

		// å¦‚æœå½“å‰æ ‘æ˜¯å­æ ‘ï¼Œåˆ™æ›´æ–°æ‰€åœ¨èŠ‚ç‚¹çš„ + - æ ‡è®°ã€‚
    	if (this.owner()) {
    		this.owner().update();
    	}
    },

	/**
	 * ç‚¹å‡»æ—¶è§¦å‘ã€‚
	 */
    onClick: function (e) {
		
    	var target = e.target;

    	if (/\bui-treenode-(minus|plus|loading)\b/.test(target.className))
    		return;

    	target = Dom.closest(target, &quot;li&quot;);

    	if (target = Dom.data(target).treeNode) {
    		this.selectNode(target);
    		return false;
    	}

    },

    init: function () {

        // æ ¹æ®å·²æœ‰çš„ DOM ç»“æ„åˆå§‹åŒ–èœå•ã€‚
    	TreeControl.prototype.init.call(this);

		// ç‚¹å‡»åå±•å¼€/æŠ˜å å­èŠ‚ç‚¹ã€‚
        Dom.on(this.elem, 'click', this.onClick, this);
    },

    invoke: function (funcName, args) {
        var i, node;
        args = args || [];
        for (i = 0 ; node = this.item(i) ; i++) {
        	node[funcName].apply(node, args);
        }
        return this;
    },

    collapse: function (duration) {
        return this.invoke('collapse', [duration]);
    },

    collapseAll: function (duration) {
        return this.invoke('collapseAll', [duration]);
    },

    expand: function (duration) {
        return this.invoke('expand', [duration]);
    },

    expandAll: function (duration) {
        return this.invoke('expandAll', [duration]);
    },

    collapseTo: function (depth, duration) {
        return this.invoke('collapseTo', [--depth, duration]);
    },

    /**
	 * æ¨¡æ‹Ÿç‚¹å‡»ä¸€é¡¹ã€‚
	 */
    selectNode: function (node) {
        if (this.trigger('selecting', node)) {
            var old = this.getSelectedNode();
            this.setSelectedNode(node);
            if (old !== node)
                this.trigger('change');
        }
        return this;
    },

    getSelectedNode: function () {
    	return this.selectedNode;
    },

    setSelectedNode: function (node) {

        // å…ˆåé€‰å½“å‰é€‰æ‹©é¡¹ã€‚
        if (this.selectedNode)
        	Dom.removeClass(this.selectedNode.elem, 'x-treenode-selected');

        // æ›´æ–°é€‰æ‹©é¡¹ã€‚
        this.selectedNode = node;

        if (node != null) {
        	Dom.addClass(node.elem, 'x-treenode-selected');
        }

        return this;
    }

})</code></span>
                                <div class="doc doc-api-detail">
                                    
                                    
                                </div>
                            </td>
                            <td>
                                <code>any</code>
                            </td>
                            <td class="doc">
                                
                            </td>
                            
                        </tr><tr id="api/TreeNode">
                            <td>
                                <a href="http://git.weidai.work/fed/frag/tree/dev-v4/components/ui/treeView/old/treeView (2).ts#L128-445" target="_blank" title="æºç ï¼šui/treeView/old/treeView (2).tsï¼Œç¬¬ 128 è¡Œ" aria-hidden="true" class="doc-icon doc-sourcelink doc-api-more">â…</a>
                                <a href="javascript://è¯¦ç»†ä¿¡æ¯" title="å±•å¼€/æŠ˜å è¯¦ç»†ä¿¡æ¯" class="doc-icon doc-api-toggle" onclick="Doc.toggleApi(this)">â®</a>
                                <code>TreeNode</code>
                                <span class="doc-api-more">: <code>any</code> = <code>TreeControl.Node.extend(ICollapsable).implement({
	
	cssClass: 'x-treenode',
	
	tpl: '&lt;a class=&quot;{cssClass}&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;',

	depth: 0,
	
	/**
	 * è·å–å½“å‰ç”¨äºæŠ˜å çš„å®¹å™¨å¯¹è±¡ã€‚
	 * @return {Control} æŠ˜å çš„å®¹å™¨å¯¹è±¡ã€‚
	 * @protected override
	 */
	body: function () {
		var sub = this.getSub();
		return sub &amp;&amp; sub.elem;
	},
	
	/**
	 * è·å–å½“å‰çš„æ–‡å­—å¯¹è±¡ã€‚
	 * @return {Control} æ–‡å­—å¯¹è±¡ã€‚
	 * @protected override
	 */
	content: function(){
		return Dom.last(this.elem);
	},
	
	/**
	 * å½“è¢«å­ç±»é‡å†™æ—¶ï¼Œç”¨äºåˆ›å»ºå­æ ‘ã€‚
	 * @param {TreeControl} treeControl è¦åˆå§‹åŒ–çš„å­æ ‘ã€‚
	 * @return {TreeControl} æ–°çš„ {@link TreeControl} å¯¹è±¡ã€‚
	 * @protected override
	 */
	createSub: function (existNode) {
		return new TreeView(existNode);
	},
	
	/**
	 * å½“è¢«å­ç±»é‡å†™æ—¶ï¼Œç”¨äºåˆå§‹åŒ–å­æ ‘ã€‚
	 * @param {TreeControl} treeControl è¦åˆå§‹åŒ–çš„å­æ ‘ã€‚
	 * @protected override
	 */
	initSub: function (treeControl) {

		// æ›´æ–°å­æ ‘çš„ç±»ã€‚
		Dom.removeClass(treeControl.elem, 'x-treeview');
		Dom.addClass(treeControl.elem, 'x-treeview-subtree');

		// æ ‡è®°å­æ ‘çš„æ·±åº¦ã€‚
	    treeControl.depth = this.depth;

		// å­æ ‘ä¸éœ€è¦é€‰æ‹©èŠ‚ç‚¹çš„åŠŸèƒ½ã€‚
	    Dom.un(treeControl.elem, 'click', treeControl.onClick);
	},

	uninitSub: function (treeControl) {

		// æ›´æ–°å­æ ‘çš„ç±»ã€‚
		Dom.addClass(treeControl.elem, 'x-treeview');
		Dom.removeClass(treeControl.elem, 'x-treeview-subtree');

		// å°†æ ‘è®¾ä¸ºç‹¬ç«‹çš„æ ‘ã€‚
		treeControl.depth = 0;

		// å­æ ‘ä¸éœ€è¦é€‰æ‹©èŠ‚ç‚¹çš„åŠŸèƒ½ã€‚
		Dom.on(treeControl.elem, 'click', treeControl.onClick, treeControl);

	},
	
	/**
	 * æ›´æ–°ä¸€ä¸ªèŠ‚ç‚¹å‰é¢æŒ‡å®šçš„å ä½ç¬¦çš„ç±»åã€‚
	 * @private
	 */
	_setSpan: function(depth, className){
		this.sub().each(function(node){
			var first = Dom.first(node.elem, depth);
			if(first.tagName == 'SPAN')
				first.className = className;
			node._setSpan(depth, className);
		});
	},
	
	_markAsLastNode: function(){
		Dom.addClass(this.elem, 'x-treenode-last');
		this._setSpan(this.depth - 1, 'x-treenode-space x-treenode-none');
	},
	
	_clearMarkAsLastNode: function(){
		Dom.removeClass(this.elem, 'x-treenode-last');
		this._setSpan(this.depth - 1, 'x-treenode-space');
	},

	/**
	 * è·å–å½“å‰èŠ‚ç‚¹çš„å ä½ span ã€‚
	 * @param {Integer} index è¦è·å–çš„ç´¢å¼•ï¼Œ æœ€é è¿‘å³çš„ç´¢å¼•ä¸º 0 ã€‚
	 * @protected
	 */
	span: function(index){
		return Dom.prev(this.content(), index);
	},
	
	/**
	 * ç”±äºå­èŠ‚ç‚¹çš„æ”¹å˜åˆ·æ–°æœ¬èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹çŠ¶æ€ã€‚
	 * @protected
	 */
	update: function(){
		
		// æ›´æ–°å›¾æ ‡ã€‚
		this.updateType();

		var sub = this.getSub();

		if (sub) {

			var last = sub.item(-1), lastNode;

			// æ›´æ–° lastNode
			if (last) {
				lastNode = this._lastNode;
				if (lastNode !== last.elem) {
					last._markAsLastNode();
					this._lastNode = last;
					if (lastNode) lastNode._clearMarkAsLastNode();
				}
			}

		}
		
	},
	
	/**
	 * æ ¹æ®å½“å‰çš„èŠ‚ç‚¹æƒ…å†µæ›´æ–°å½“å‰èŠ‚ç‚¹çš„å›¾æ ‡ã€‚
	 * @protected
	 */
	updateType: function () {
		var sub = this.getSub();
		this.setType(sub &amp;&amp; Dom.first(sub.elem) ? (this.isCollapsed() ? 'plus' : 'minus') : 'normal');
	},
	
	/**
	 * è·å–ä¸€ä¸ªå€¼ï¼Œè¯¥å€¼æŒ‡ç¤ºå½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹ã€‚
	 * @return {Boolean}
	 * @protected
	 */
	isLastNode: function () {
		var parent = this.parent();
		return parent &amp;&amp; parent._lastNode === this;
	},
	
	onDblClick: function(e){
		this.toggleCollapse();
		e.preventDefault();
		e.stopPropagation();
	},

	onCollapse: function () {
		ICollapsable.onCollapse.call(this);
		this.updateType();
	},

	onExpanding: function () {
		this.setType(this.isCollapsed() ? 'minus' : 'plus');
		ICollapsable.onExpanding.call(this);
	},

	init: function (options) {
		TreeControl.Node.prototype.init.call(this, options);
		Dom.setStyle(this.elem, 'user-select', 'none');
		Dom.on(this.elem, 'dblclick', this.onDblClick, this);
	},
	
	/**
	 * è·å–å½“å‰èŠ‚ç‚¹çš„å›¾æ ‡ã€‚
	 */
	getType: function(){
		var span = this.span(0);
		return span ? (/x-treenode-(.+)/.exec(span.className.replace(/\bui-treenode-space\b/, '')) || [0, &quot;line&quot;])[1] : null;
	},
	
	/**
	 * è®¾ç½®å½“å‰èŠ‚ç‚¹çš„å›¾æ ‡ã€‚
	 * @param {String} type ç±»å‹ã€‚è‚¯èƒ½çš„å€¼å¦‚ï¼š 'normal' 'plus' 'minus' 'none' 'loading' 'line'ã€‚
	 * @return this
	 */
	setType: function(type){
		var span = this.span(0);
		if(span) {
			span.className = 'x-treenode-space x-treenode-' + type;
		}
		return this;
	},
	
	/**
	 * å±•å¼€å½“å‰èŠ‚ç‚¹åŠå­èŠ‚ç‚¹ã€‚
	 * @param {Integer} duration æŠ˜å åŠ¨ç”»ä½¿ç”¨çš„æ¯«ç±³æ•°ã€‚
	 * @param {Integer} maxDepth=0 æœ€å¤§æŠ˜å çš„æ·±åº¦ã€‚é»˜è®¤ä¸º -1 è¡¨ç¤ºå…¨éƒ¨æŠ˜å ã€‚
	 * @return this
	 */
	expandAll: function(duration, maxDepth){
		if (this.getSub() &amp;&amp; !(maxDepth === 0)) {
			this.expand(duration);
			this.invoke('expandAll', [duration, --maxDepth]);
		}
		return this;
	},
	
	/**
	 * æŠ˜å å½“å‰èŠ‚ç‚¹åŠå­èŠ‚ç‚¹ã€‚
	 * @param {Integer} duration æŠ˜å åŠ¨ç”»ä½¿ç”¨çš„æ¯«ç±³æ•°ã€‚
	 * @param {Integer} maxDepth=0 æœ€å¤§æŠ˜å çš„æ·±åº¦ã€‚é»˜è®¤ä¸º -1 è¡¨ç¤ºå…¨éƒ¨æŠ˜å ã€‚
	 * @return this
	 */
	collapseAll: function(duration, maxDepth){
		if (this.getSub() &amp;&amp; !(maxDepth === 0)) {
			this.invoke('collapseAll', [duration, --maxDepth]);
			this.collapse(duration);
		}
		return this;
	},
	
	/**
	 * å±•å¼€å½“å‰èŠ‚ç‚¹ï¼Œä½†æŠ˜å æŒ‡å®šæ·±åº¦ä»¥åçš„èŠ‚ç‚¹ã€‚
	 */
	collapseTo: function(depth, duration){
		duration = duration === undefined ? 0 : duration;
		depth = depth === undefined ? 1 : depth;
		
		if(depth &gt; 0){
			this.expand(duration);
		} else {
			this.collapse(duration);
		}
		
		this.invoke('collapseTo', [--depth, duration]);
	},
	
	invoke: function (funcName, args) {
		var sub = this.getSub();
		if (sub) {
			sub.invoke(funcName, args);
		}
		return this;
	},

	/**
	 * è·å–å½“å‰èŠ‚ç‚¹çš„æ·±åº¦ã€‚
	 * @return {Integer} è¿”å›èŠ‚ç‚¹æ·±åº¦ã€‚
	 */
	getDepth: function(){
		return this.depth;
	},

	/**
	 * è®¾ç½®å½“å‰èŠ‚ç‚¹çš„æ·±åº¦ã€‚
	 * @param {Integer} value è¦è®¾ç½®çš„æ·±åº¦ã€‚
	 * @return this
	 */
	setDepth: function(value){
		
		//assert(value &gt;= 0, &quot;TreeNode#setDepth(value): {value} å¿…é¡»æ˜¯ä¸å°äº 0 çš„æ•´æ•°&quot;, value);
		
		var me = this,
			currentDepth = me.getDepth(),
			span,
			current = me;
		
		// åˆ é™¤å¤šä½™çš„å ä½ç¬¦ã€‚
		
		while(currentDepth &gt; value){
			Dom.remove(Dom.first(this.elem));
			currentDepth--;
		}
	
		// è¡¥ä¸Šä¸å¤Ÿçš„å ä½ç¬¦ã€‚
		
		while(currentDepth &lt; value){
			Dom.prepend(this.elem, '&lt;span class=&quot;x-treenode-space&quot;&gt;&lt;/span&gt;');
			currentDepth++;
		}
		
		// æ›´æ–°æ·±åº¦ã€‚
		
		this.depth = value;
		
		// ç»‘å®šæœ€åä¸€ä¸ª span çš„ç‚¹å‡»äº‹ä»¶ã€‚
		
		// è·å–ç¬¬ä¸€ä¸ªå ä½ç¬¦ã€‚
		span = this.span(0);
		
		if(currentDepth) {
			Dom.un(span, 'click', this.onDblClick);
			Dom.on(span, 'click', this.onDblClick, this);
		}
		
		// æ›´æ–° spans çš„ class çŠ¶æ€ã€‚
		
		while ((current = current.parent()) &amp;&amp; (span = Dom.prev(span))) {
			span.className = current.isLastNode &amp;&amp; current.isLastNode() ? 'x-treenode-space x-treenode-none' : 'x-treenode-space';
		}
		
		me.updateType();
		
		// å¯¹å­èŠ‚ç‚¹è®¾ç½®æ·±åº¦+1
		me.invoke('setDepth', [++value]);
	},
	
	ensureVisible: function(duration){
		var n = this;
		while(n = n.parent()) {
			n.expand(duration);
		}

		//   this.scrollIntoView();
		
		return this;
	}

})</code></span>
                                <div class="doc doc-api-detail">
                                    <p class="doc">è¡¨ç¤ºæ˜¯ {@link TreeView} ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p>

                                    
                                </div>
                            </td>
                            <td>
                                <code>any</code>
                            </td>
                            <td class="doc">
                                <p class="doc">è¡¨ç¤ºæ˜¯ {@link TreeView} ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p>

                            </td>
                            
                        </tr></table></div>
                        
</article>
    </div>
    <footer id="doc_footer">
        <div class="doc-container">
            <div id="doc_footer_links">
                <a href="http://git.weidai.work/fed/frag/issues" target="_blank">åé¦ˆå»ºè®®</a> |
                <a href="../../../../docs/about/contributing.html">è´¡çŒ®æŒ‡å—</a> |
                <a href="https://gitter.im/Teal/TealUI" target="_blank">åœ¨çº¿è®¨è®º</a>
            </div>
            &copy; 2011-2017 The Teal Team. All Rights Reserved.
        </div>
    </footer>
    <script src="../../../../assets/doc/doc.js"></script>
    <script>
        Doc.init({"root":"../../../..","dir":"components","active":"ui/treeView/old/treeView (2).html","imports":["ui/treeView/old/treeView (2)"]})
    </script>
    <script src="../../../../components/index.js"></script>
    <script>!location.port && /^http/.test(location.protocol) && (document.body.appendChild(document.createElement("script")).src = "//hm.baidu.com/hm.js?9a3cb18d91be19c36c5f9725822b64e8")</script>
</body>
</html>