{"version":3,"file":"tagChooser.js","sourceRoot":"../../..","sources":["components/ui/tagChooser/tagChooser.tsx"],"sourcesContent":["import { Control, VNode, bind } from \"control\";\r\nimport \"./tagChooser.scss\";\r\n\r\n/**\r\n * 表示一个标签选择器。\r\n */\r\nexport class TagChooser extends Control {\r\n\r\n    /**\r\n     * 当被子类重写时负责渲染当前控件。\r\n     * @return 返回一个虚拟节点。\r\n     */\r\n    protected render() {\r\n        return <div class=\"x-tagchooser\"></div>;\r\n    }\r\n\r\n}\r\n\r\nexport default TagChooser;\r\n// #todo\r\n\r\n/**\r\n * @fileOverview 标签选择器。\r\n * @description 提供备选项帮助用户书写信息。\r\n * @author  xuld\r\n */\r\n\r\ntypeof include === \"function\" && include(\"../control/base\");\r\n\r\n/**\r\n * 一个标签选择器。\r\n */\r\nvar TagChooser = Control.extend({\r\n\r\n    role: 'tagchooser',\r\n\r\n    selectItem: function (tag, e) {\r\n        var me = this;\r\n        var values = me.target.text().split(/\\s+/);\r\n        var value = Dom(tag).text();\r\n        var index = values.indexOf(value);\r\n        if (index < 0) {\r\n            values.push(value)\r\n        } else {\r\n            values.splice(index, 1);\r\n        }\r\n        me.target.text(values.join(' ').trim());\r\n        me.update();\r\n    },\r\n\r\n    update: function () {\r\n        var me = this;\r\n        var values = me.target.text().split(/\\s+/);\r\n        me.dom.find(\"a\").each(function (elem) {\r\n            elem = Dom(elem);\r\n            elem.toggleClass('x-tagchooser-selected', values.indexOf(elem.text()) >= 0);\r\n        });\r\n        return me;\r\n    },\r\n\r\n    init: function () {\r\n        var me = this;\r\n        me.target = (Dom(me.target).valueOf() || me.dom.prev()).on(\"input\", function () {\r\n            me.update();\r\n        });\r\n        me.dom.on(\"click\", \"a\", function (e) {\r\n            me.selectItem(this, e);\r\n        });\r\n        me.update();\r\n    }\r\n\r\n});"],"mappings":";;IAGA;;OAEG;IACH,gBAAwB,SAAQ,iBAAO;QAEnC;;;WAGG;QACO,MAAM;YACZ,MAAM,CAAC,gCAAK,KAAK,EAAC,cAAc,GAAO,CAAC;QAC5C,CAAC;KAEJ;IAVD,gCAUC;IAED,kBAAe,UAAU,CAAC;IAC1B,QAAQ;IAER;;;;OAIG;IAEH,OAAO,OAAO,KAAK,UAAU,IAAI,OAAO,CAAC,iBAAiB,CAAC,CAAC;IAE5D;;OAEG;IACH,IAAI,UAAU,GAAG,iBAAO,CAAC,MAAM,CAAC;QAE5B,IAAI,EAAE,YAAY;QAElB,UAAU,EAAE,UAAU,GAAG,EAAE,CAAC;YACxB,IAAI,EAAE,GAAG,IAAI,CAAC;YACd,IAAI,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAC3C,IAAI,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;YAC5B,IAAI,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAClC,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC;gBACZ,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;YACtB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACJ,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAC5B,CAAC;YACD,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;YACxC,EAAE,CAAC,MAAM,EAAE,CAAC;QAChB,CAAC;QAED,MAAM,EAAE;YACJ,IAAI,EAAE,GAAG,IAAI,CAAC;YACd,IAAI,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAC3C,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI;gBAChC,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;gBACjB,IAAI,CAAC,WAAW,CAAC,uBAAuB,EAAE,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;YAChF,CAAC,CAAC,CAAC;YACH,MAAM,CAAC,EAAE,CAAC;QACd,CAAC;QAED,IAAI,EAAE;YACF,IAAI,EAAE,GAAG,IAAI,CAAC;YACd,EAAE,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE;gBAChE,EAAE,CAAC,MAAM,EAAE,CAAC;YAChB,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,OAAO,EAAE,GAAG,EAAE,UAAU,CAAC;gBAC/B,EAAE,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAC3B,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,MAAM,EAAE,CAAC;QAChB,CAAC;KAEJ,CAAC,CAAC"}